@{
    ViewData["Title"] = ".NET Identity - User Security Made Easy";
}

<div class="container">
    <h1 class="text-center">.NET Identity: User Security Made Easy</h1>

    <div class="beginner-note">
        <div class="beginner-note-icon">
            <i class="fas fa-user-shield"></i>
        </div>
        <div class="beginner-note-content">
            <h4>Security Doesn't Have to Be Scary!</h4>
            <p><strong>Think of .NET Identity as a professional security team</strong> that handles all user management for you:</p>
            <ul>
                <li><strong>Bouncer:</strong> Checks who's allowed in (authentication)</li>
                <li><strong>VIP Host:</strong> Decides what areas you can access (authorization)</li>
                <li><strong>Concierge:</strong> Manages user profiles and preferences</li>
                <li><strong>Security Guard:</strong> Protects against unauthorized access</li>
            </ul>
            <p><strong>In simple terms:</strong> .NET Identity is a pre-built system that handles user login, registration, passwords, and permissions so you don't have to build it from scratch!</p>
        </div>
    </div>

    <div class="important-note">
        <h4><i class="fas fa-star"></i> Why This Matters</h4>
        <p>Security is one of the most important (and tricky) parts of web development. Getting it wrong can lead to data breaches, stolen information, and unhappy users. .NET Identity gives you a professional-grade security system that's been tested by millions of applications.</p>
    </div>

    <div class="intro-section">
        <h2>What Problems Does Identity Solve?</h2>
        <p>Before .NET Identity, developers had to build all this from scratch. Here's what it handles for you:</p>
        
        <div class="problems-solved">
            <div class="problem-item">
                <div class="problem-icon">
                    <i class="fas fa-user-plus"></i>
                </div>
                <h5>User Registration</h5>
                <p>Creating accounts, validating emails, storing passwords securely</p>
            </div>
            
            <div class="problem-item">
                <div class="problem-icon">
                    <i class="fas fa-sign-in-alt"></i>
                </div>
                <h5>Login/Logout</h5>
                <p>Secure authentication, session management, remember me functionality</p>
            </div>
            
            <div class="problem-item">
                <div class="problem-icon">
                    <i class="fas fa-key"></i>
                </div>
                <h5>Password Management</h5>
                <p>Password hashing, reset functionality, complexity requirements</p>
            </div>
            
            <div class="problem-item">
                <div class="problem-icon">
                    <i class="fas fa-user-tag"></i>
                </div>
                <h5>Roles & Permissions</h5>
                <p>User roles (Admin, User, Moderator), fine-grained permissions</p>
            </div>
            
            <div class="problem-item">
                <div class="problem-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h5>Security Features</h5>
                <p>Two-factor authentication, lockout on failed attempts, email confirmation</p>
            </div>
            
            <div class="problem-item">
                <div class="problem-icon">
                    <i class="fas fa-user-cog"></i>
                </div>
                <h5>Profile Management</h5>
                <p>User profiles, avatar uploads, preference settings</p>
            </div>
        </div>
    </div>

    <div class="identity-components">
        <h2><i class="fas fa-puzzle-piece"></i> Key Components of .NET Identity</h2>
        
        <div class="components-grid">
            <div class="component-card">
                <div class="component-header">
                    <div class="component-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h4>User Manager</h4>
                </div>
                <div class="component-content">
                    <p><strong>The "User Account Manager"</strong></p>
                    <ul>
                        <li>Create and delete user accounts</li>
                        <li>Find users by email/username</li>
                        <li>Update user information</li>
                        <li>Change passwords</li>
                        <li>Manage email confirmation</li>
                    </ul>
                </div>
            </div>
            
            <div class="component-card">
                <div class="component-header">
                    <div class="component-icon">
                        <i class="fas fa-sign-in-alt"></i>
                    </div>
                    <h4>SignIn Manager</h4>
                </div>
                <div class="component-content">
                    <p><strong>The "Door Security"</strong></p>
                    <ul>
                        <li>Handle user login/logout</li>
                        <li>Validate credentials</li>
                        <li>Manage authentication cookies</li>
                        <li>Two-factor authentication</li>
                        <li>External login providers (Google, Facebook)</li>
                    </ul>
                </div>
            </div>
            
            <div class="component-card">
                <div class="component-header">
                    <div class="component-icon">
                        <i class="fas fa-user-tag"></i>
                    </div>
                    <h4>Role Manager</h4>
                </div>
                <div class="component-content">
                    <p><strong>The "VIP Coordinator"</strong></p>
                    <ul>
                        <li>Create and manage roles</li>
                        <li>Assign users to roles</li>
                        <li>Check user permissions</li>
                        <li>Role-based authorization</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="conceptual-section">
        <h2><i class="fas fa-brain"></i> How .NET Identity Works - Conceptually</h2>
        
        <div class="concept-steps">
            <div class="concept-step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <h4>Setup in Program.cs</h4>
                    <p>You configure Identity services with your desired settings:</p>
                    <ul>
                        <li>Password requirements (length, complexity)</li>
                        <li>User requirements (unique email)</li>
                        <li>Lockout settings (failed attempts before lockout)</li>
                        <li>Cookie settings (login persistence)</li>
                    </ul>
                </div>
            </div>
            
            <div class="concept-step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <h4>Custom User Model</h4>
                    <p>You create a class that inherits from <code>IdentityUser</code>:</p>
                    <ul>
                        <li>Add custom properties (FirstName, LastName, BirthDate)</li>
                        <li>Add navigation properties for relationships</li>
                        <li>Add calculated properties or methods</li>
                    </ul>
                </div>
            </div>
            
            <div class="concept-step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <h4>Account Controller</h4>
                    <p>Your controller uses the injected managers:</p>
                    <ul>
                        <li><strong>UserManager:</strong> Creates users, updates profiles</li>
                        <li><strong>SignInManager:</strong> Handles login/logout</li>
                        <li>Handles registration, login, logout actions</li>
                        <li>Manages redirects based on authentication status</li>
                    </ul>
                </div>
            </div>
            
            <div class="concept-step">
                <div class="step-number">4</div>
                <div class="step-content">
                    <h4>Database Setup</h4>
                    <p>Identity automatically creates necessary tables:</p>
                    <ul>
                        <li><strong>AspNetUsers:</strong> Stores user accounts</li>
                        <li><strong>AspNetRoles:</strong> Stores role definitions</li>
                        <li><strong>AspNetUserRoles:</strong> Links users to roles</li>
                        <li><strong>AspNetClaims:</strong> Stores permission claims</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="security-features">
        <h2><i class="fas fa-shield-alt"></i> Built-in Security Features</h2>
        
        <div class="features-grid">
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <h5>Password Hashing</h5>
                <p>Passwords are never stored in plain text. They're hashed using strong algorithms (like PBKDF2) before saving to database.</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-user-lock"></i>
                </div>
                <h5>Account Lockout</h5>
                <p>Automatically locks accounts after too many failed login attempts to prevent brute force attacks.</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-envelope"></i>
                </div>
                <h5>Email Confirmation</h5>
                <p>Requires users to confirm their email address before accessing the application.</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h5>Two-Factor Auth</h5>
                <p>Supports two-factor authentication via SMS or authenticator apps for extra security.</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-external-link-alt"></i>
                </div>
                <h5>External Logins</h5>
                <p>Users can log in with Google, Facebook, Twitter, or other external providers.</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-history"></i>
                </div>
                <h5>Password History</h5>
                <p>Prevents users from reusing old passwords to maintain security.</p>
            </div>
        </div>
    </div>

    <div class="integration-section">
        <h2><i class="fas fa-project-diagram"></i> How Identity Fits in Your Architecture</h2>
        
        <div class="architecture-flow">
            <div class="arch-step">
                <h5>1. User Registration Flow</h5>
                <div class="arch-description">
                    <p>When a user registers:</p>
                    <ol>
                        <li><strong>View:</strong> User fills registration form</li>
                        <li><strong>Controller:</strong> Receives form data, validates basic input</li>
                        <li><strong>UserManager:</strong> Creates user with hashed password</li>
                        <li><strong>Database:</strong> Stores user securely</li>
                        <li><strong>SignInManager:</strong> Automatically logs user in</li>
                    </ol>
                </div>
            </div>
            
            <div class="arch-step">
                <h5>2. Login Flow</h5>
                <div class="arch-description">
                    <p>When a user logs in:</p>
                    <ol>
                        <li><strong>View:</strong> User enters credentials</li>
                        <li><strong>Controller:</strong> Passes credentials to SignInManager</li>
                        <li><strong>SignInManager:</strong> Validates password, checks lockout status</li>
                        <li><strong>Database:</strong> Verifies credentials against stored hash</li>
                        <li><strong>Cookie:</strong> Creates secure authentication cookie</li>
                    </ol>
                </div>
            </div>
            
            <div class="arch-step">
                <h5>3. Authorization Flow</h5>
                <div class="arch-description">
                    <p>When accessing protected pages:</p>
                    <ol>
                        <li><strong>Middleware:</strong> Checks authentication cookie</li>
                        <li><strong>[Authorize] Attribute:</strong> Verifies user is logged in</li>
                        <li><strong>[Authorize(Roles = "Admin")]:</strong> Checks specific role</li>
                        <li><strong>Access Granted/Denied:</strong> Based on permissions</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <div class="practical-benefits">
        <h2><i class="fas fa-check-circle"></i> Practical Benefits for Developers</h2>
        
        <div class="benefits-grid">
            <div class="benefit">
                <div class="benefit-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <h5>Fast Implementation</h5>
                <p>Get secure user management working in hours, not weeks. The scaffolding templates create everything you need.</p>
            </div>
            
            <div class="benefit">
                <div class="benefit-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h5>Proven Security</h5>
                <p>Built by Microsoft security experts. No need to worry about implementing cryptographic algorithms correctly.</p>
            </div>
            
            <div class="benefit">
                <div class="benefit-icon">
                    <i class="fas fa-expand-alt"></i>
                </div>
                <h5>Easy to Extend</h5>
                <p>Add custom properties to users, create custom roles, or implement complex permission systems as needed.</p>
            </div>
            
            <div class="benefit">
                <div class="benefit-icon">
                    <i class="fas fa-sync-alt"></i>
                </div>
                <h5>Regular Updates</h5>
                <p>Microsoft continuously updates Identity with security patches and new features as part of .NET updates.</p>
            </div>
        </div>
    </div>

    <div class="quiz-section">
        <h3><i class="fas fa-brain"></i> Quick Check: .NET Identity Knowledge</h3>
        <div class="quiz-question">
            <p><strong>Question:</strong> Which of these are handled by .NET Identity?</p>
            
            <div class="quiz-options">
                <button class="quiz-option" data-correct="true">
                    <i class="fas fa-key"></i> Password hashing and security
                </button>
                <button class="quiz-option" data-correct="true">
                    <i class="fas fa-user-tag"></i> Role-based authorization
                </button>
                <button class="quiz-option" data-correct="false">
                    <i class="fas fa-shopping-cart"></i> Shopping cart functionality
                </button>
                <button class="quiz-option" data-correct="true">
                    <i class="fas fa-envelope"></i> Email confirmation system
                </button>
                <button class="quiz-option" data-correct="false">
                    <i class="fas fa-chart-bar"></i> Business analytics
                </button>
                <button class="quiz-option" data-correct="true">
                    <i class="fas fa-lock"></i> Account lockout on failed attempts
                </button>
            </div>
            
            <div class="quiz-feedback">
                <p id="quiz-feedback-text"></p>
            </div>
        </div>
    </div>

    <div class="next-steps">
        <h3><i class="fas fa-road"></i> What You'll Learn Next</h3>
        <div class="steps-grid">
            <div class="step">
                <div class="step-icon">
                    <i class="fas fa-user-tag"></i>
                </div>
                <h5>Identity Roles</h5>
                <p>Learn how to create and manage user roles (Admin, User, Moderator) and control access based on roles.</p>
            </div>
            
            <div class="step">
                <div class="step-icon">
                    <i class="fas fa-fingerprint"></i>
                </div>
                <h5>Authentication vs Authorization</h5>
                <p>Understand the difference between verifying identity (authentication) and controlling access (authorization).</p>
            </div>
            
            <div class="step">
                <div class="step-icon">
                    <i class="fas fa-lock-open"></i>
                </div>
                <h5>Advanced Security</h5>
                <p>Explore two-factor authentication, external logins, and custom security policies.</p>
            </div>
        </div>
    </div>

    <div class="navigation-buttons">
        <a href="@Url.Action("ServiceLayer", "AdvancedWebApp")" class="btn btn-outline-primary ajax-link" data-path="/AdvancedWebApp/ServiceLayer">← Back: Service Layer</a>
        <a href="@Url.Action("IdentityRoles", "AdvancedWebApp")" class="btn btn-primary ajax-link" data-path="/AdvancedWebApp/IdentityRoles">Next: Identity Roles →</a>
    </div>
</div>

<style>
    .container { 
        max-width: 1000px; 
        padding: 20px; 
        background-color: var(--bs-body-bg); 
    }
    
    h1, h2, h3, h4, h5 { 
        color: var(--bs-heading-color); 
        margin-bottom: 15px; 
    }
    
    h1 { 
        border-bottom: 2px solid var(--bs-purple); 
        padding-bottom: 10px; 
    }
    
    .beginner-note {
        background-color: rgba(111, 66, 193, 0.1);
        border: 2px solid var(--bs-purple);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 30px;
        display: flex;
        gap: 15px;
        align-items: flex-start;
    }
    
    .beginner-note-icon {
        background-color: var(--bs-purple);
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        flex-shrink: 0;
    }
    
    .important-note {
        background-color: rgba(255, 193, 7, 0.2);
        border: 2px solid var(--bs-warning);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 30px;
    }
    
    .intro-section {
        margin-bottom: 40px;
    }
    
    .problems-solved {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .problem-item {
        text-align: center;
        padding: 20px;
        background-color: rgba(111, 66, 193, 0.1);
        border-radius: 8px;
        border: 1px solid rgba(111, 66, 193, 0.3);
    }
    
    .problem-icon {
        font-size: 2rem;
        color: var(--bs-purple);
        margin-bottom: 10px;
    }
    
    .identity-components {
        margin: 40px 0;
    }
    
    .components-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .component-card {
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        border: 1px solid var(--bs-secondary);
    }
    
    .component-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 15px;
    }
    
    .component-icon {
        background-color: var(--bs-purple);
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
    }
    
    .component-content ul {
        margin: 0;
        padding-left: 20px;
    }
    
    .component-content li {
        margin-bottom: 8px;
    }
    
    .conceptual-section {
        margin: 40px 0;
        padding: 25px;
        background-color: rgba(23, 162, 184, 0.1);
        border: 1px solid var(--bs-info);
        border-radius: 10px;
    }
    
    .concept-steps {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-top: 20px;
    }
    
    .concept-step {
        display: flex;
        gap: 20px;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        border-left: 4px solid var(--bs-info);
    }
    
    .step-number {
        background-color: var(--bs-info);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.2rem;
        flex-shrink: 0;
    }
    
    .step-content h4 {
        color: var(--bs-info);
        margin-bottom: 10px;
    }
    
    .step-content ul {
        margin: 10px 0 0 0;
        padding-left: 20px;
    }
    
    .step-content li {
        margin-bottom: 5px;
    }
    
    .security-features {
        margin: 40px 0;
    }
    
    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .feature {
        text-align: center;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        border: 1px solid var(--bs-secondary);
    }
    
    .feature-icon {
        font-size: 2rem;
        color: var(--bs-info);
        margin-bottom: 15px;
    }
    
    .integration-section {
        margin: 40px 0;
        padding: 25px;
        background-color: rgba(40, 167, 69, 0.1);
        border: 1px solid var(--bs-success);
        border-radius: 10px;
    }
    
    .architecture-flow {
        display: flex;
        flex-direction: column;
        gap: 25px;
        margin-top: 20px;
    }
    
    .arch-step {
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        border-left: 4px solid var(--bs-success);
    }
    
    .arch-step h5 {
        color: var(--bs-success);
        margin-bottom: 15px;
    }
    
    .arch-description ol {
        margin: 10px 0 0 0;
        padding-left: 20px;
    }
    
    .arch-description li {
        margin-bottom: 8px;
    }
    
    .practical-benefits {
        margin: 40px 0;
    }
    
    .benefits-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .benefit {
        text-align: center;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        border: 1px solid var(--bs-warning);
    }
    
    .benefit-icon {
        font-size: 2rem;
        color: var(--bs-warning);
        margin-bottom: 15px;
    }
    
    .quiz-section {
        margin: 40px 0;
        padding: 25px;
        background-color: rgba(255, 193, 7, 0.1);
        border: 1px solid var(--bs-warning);
        border-radius: 10px;
    }
    
    .quiz-question {
        margin-top: 20px;
    }
    
    .quiz-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 10px;
        margin: 20px 0;
    }
    
    .quiz-option {
        padding: 15px;
        background-color: rgba(0, 0, 0, 0.2);
        border: 2px solid var(--bs-secondary);
        border-radius: 8px;
        color: var(--bs-body-color);
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 10px;
        text-align: left;
    }
    
    .quiz-option:hover {
        background-color: rgba(0, 0, 0, 0.3);
        transform: translateY(-2px);
    }
    
    .quiz-option.correct {
        background-color: rgba(40, 167, 69, 0.3);
        border-color: var(--bs-success);
    }
    
    .quiz-option.incorrect {
        background-color: rgba(220, 53, 69, 0.3);
        border-color: var(--bs-danger);
    }
    
    .quiz-option.selected {
        border-width: 3px;
    }
    
    .quiz-feedback {
        padding: 15px;
        background-color: rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        display: none;
    }
    
    .quiz-feedback.show {
        display: block;
        animation: fadeIn 0.5s;
    }
    
    .next-steps {
        margin: 40px 0;
        padding: 25px;
        background-color: rgba(108, 117, 125, 0.1);
        border: 1px solid var(--bs-secondary);
        border-radius: 10px;
    }
    
    .steps-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .step {
        text-align: center;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
    }
    
    .step-icon {
        background-color: var(--bs-purple);
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        margin: 0 auto 15px;
    }
    
    .navigation-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 40px;
        padding-top: 20px;
        border-top: 2px solid var(--bs-border-color);
    }
    
    .btn {
        padding: 12px 25px;
        border-radius: 6px;
        font-weight: 500;
        transition: all 0.3s;
    }
    
    .btn:hover {
        transform: translateY(-2px);
    }
    
    @@media (max-width: 768px) {
        .beginner-note {
            flex-direction: column;
            text-align: center;
        }
        
        .concept-step {
            flex-direction: column;
            text-align: center;
        }
        
        .navigation-buttons {
            flex-direction: column;
            gap: 10px;
        }
        
        .navigation-buttons .btn {
            width: 100%;
            text-align: center;
        }
    }
</style>

<script>
$(document).ready(function() {
    $('.quiz-option').click(function() {
        const $this = $(this);
        const isCorrect = $this.data('correct') === true;

        $('.quiz-option').removeClass('correct incorrect selected');

        $this.addClass('selected');

        $this.addClass(isCorrect ? 'correct' : 'incorrect');

        let feedbackText;
        if (isCorrect) {
            feedbackText = 'Correct! .NET Identity handles user security features like password hashing, roles, email confirmation, and account lockout. Business features like shopping carts and analytics are separate concerns.';
        } else {
            feedbackText = 'Actually, .NET Identity focuses specifically on user security and authentication. Business features like shopping carts and analytics should be implemented separately in your application layers.';
        }
        
        $('#quiz-feedback-text').text(feedbackText);
        $('.quiz-feedback').addClass('show');
    });

    const conceptSteps = $('.concept-step');
    conceptSteps.each(function(index) {
        $(this).css({
            'opacity': '0',
            'transform': 'translateY(20px)',
            'transition': 'all 0.5s ease ' + (index * 0.2) + 's'
        });
    });
    
    setTimeout(() => {
        conceptSteps.each(function() {
            $(this).css({
                'opacity': '1',
                'transform': 'translateY(0)'
            });
        });
    }, 300);

    $('.navigation-buttons a').addClass('ajax-link');
});
</script>