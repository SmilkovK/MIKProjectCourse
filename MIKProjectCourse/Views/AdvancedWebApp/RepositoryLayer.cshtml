@{
    ViewData["Title"] = "Repository Layer - The Pantry Worker";
}

<div class="container">
    <h1 class="text-center">Repository Layer: The Pantry Worker</h1>

    <div class="beginner-note">
        <div class="beginner-note-icon">
            <i class="fas fa-database"></i>
        </div>
        <div class="beginner-note-content">
            <h4>Remember the Restaurant Analogy!</h4>
            <p><strong>Repository = Pantry Worker in a restaurant</strong></p>
            <ul>
                <li><strong>One job:</strong> Get ingredients from storage when asked</li>
                <li><strong>Don't decide recipes:</strong> Never tells chef how to cook</li>
                <li><strong>Don't cook:</strong> Never touches the actual cooking</li>
                <li><strong>Just fetches:</strong> "Here are the tomatoes you asked for"</li>
            </ul>
            <p><strong>In web terms:</strong> Repositories handle all database operations. They're the only layer that talks directly to the database!</p>
        </div>
    </div>

    <div class="important-note">
        <h4><i class="fas fa-star"></i> What You Already Know</h4>
        <p>You already understand databases from previous sections! You know about tables, relationships, and basic SQL. The Repository Layer is simply a clean way to organize all your database code in one place, making it easier to maintain and test.</p>
    </div>

    <div class="intro-section">
        <h2>The Repository's Simple Job</h2>
        <p>Repositories have the simplest job of all layers. Their only responsibility is to perform CRUD operations on the database.</p>
        
        <div class="repository-tasks">
            <div class="task-card">
                <div class="task-icon">
                    <i class="fas fa-plus"></i>
                </div>
                <h5>Create</h5>
                <p>Add new records to the database</p>
            </div>
            
            <div class="task-card">
                <div class="task-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h5>Read</h5>
                <p>Retrieve data from the database</p>
            </div>
            
            <div class="task-card">
                <div class="task-icon">
                    <i class="fas fa-edit"></i>
                </div>
                <h5>Update</h5>
                <p>Modify existing records</p>
            </div>
            
            <div class="task-card">
                <div class="task-icon">
                    <i class="fas fa-trash"></i>
                </div>
                <h5>Delete</h5>
                <p>Remove records from the database</p>
            </div>
        </div>
    </div>

    <div class="code-section">
        <h2>Repository Code Structure</h2>
        <p>Repositories use Entity Framework to interact with the database. Here's what they look like:</p>
        
        <div class="code-example">
            <div class="example-tabs">
                <button class="example-tab active" data-target="interface">Repository Interface</button>
                <button class="example-tab" data-target="implementation">Repository Implementation</button>
                <button class="example-tab" data-target="entity">Database Entity</button>
            </div>
            
            <div class="tab-content active" id="interface-tab">
                <div class="code-explanation">
                    <h5><i class="fas fa-info-circle"></i> Interface - The "Contract"</h5>
                    <p>The interface defines WHAT the repository can do, but not HOW it does it. This allows you to:</p>
                    <ul>
                        <li>Switch database providers easily (SQL Server, PostgreSQL, etc.)</li>
                        <li>Create mock repositories for testing</li>
                        <li>Change implementations without affecting other layers</li>
                    </ul>
                </div>
<pre><code class="language-csharp">public interface IProductRepository
{
    // Get all products
    IEnumerable&lt;Product&gt; GetAll();
    
    // Get single product by ID
    Product GetById(int id);
    
    // Add new product
    void Add(Product product);
    
    // Update existing product
    void Update(Product product);
    
    // Delete product
    void Delete(int id);
    
    // Custom query methods
    IEnumerable&lt;Product&gt; GetByCategory(string category);
    IEnumerable&lt;Product&gt; GetInStock();
    IEnumerable&lt;Product&gt; SearchByName(string name);
}</code></pre>
            </div>
            
            <div class="tab-content" id="implementation-tab">
                <div class="code-explanation">
                    <h5><i class="fas fa-code"></i> Implementation - The "Worker"</h5>
                    <p>This is where the actual database operations happen using Entity Framework:</p>
                </div>
<pre><code class="language-csharp">public class ProductRepository : IProductRepository
{
    private readonly ApplicationDbContext _context;
    
    // Constructor gets the database context
    public ProductRepository(ApplicationDbContext context)
    {
        _context = context;
    }
    
    public IEnumerable&lt;Product&gt; GetAll()
    {
        // Simple: Get all products
        return _context.Products.ToList();
    }
    
    public Product GetById(int id)
    {
        // Simple: Find product by ID
        return _context.Products.Find(id);
    }
    
    public void Add(Product product)
    {
        // Simple: Add product to database
        _context.Products.Add(product);
        _context.SaveChanges();
    }
    
    public void Update(Product product)
    {
        // Simple: Mark as modified and save
        _context.Products.Update(product);
        _context.SaveChanges();
    }
    
    public void Delete(int id)
    {
        // Simple: Find and remove
        var product = _context.Products.Find(id);
        if (product != null)
        {
            _context.Products.Remove(product);
            _context.SaveChanges();
        }
    }
    
    public IEnumerable&lt;Product&gt; GetByCategory(string category)
    {
        // Custom query: Filter by category
        return _context.Products
            .Where(p => p.Category == category)
            .ToList();
    }
    
    public IEnumerable&lt;Product&gt; GetInStock()
    {
        // Custom query: Only products with stock > 0
        return _context.Products
            .Where(p => p.Stock > 0)
            .ToList();
    }
    
    public IEnumerable&lt;Product&gt; SearchByName(string name)
    {
        // Custom query: Search by name (case insensitive)
        return _context.Products
            .Where(p => p.Name.Contains(name, StringComparison.OrdinalIgnoreCase))
            .ToList();
    }
}</code></pre>
            </div>
            
            <div class="tab-content" id="entity-tab">
                <div class="code-explanation">
                    <h5><i class="fas fa-table"></i> Entity - The "Model"</h5>
                    <p>This represents a database table. Entity Framework uses this to create and query the database:</p>
                </div>
<pre><code class="language-csharp">public class Product
{
    public int Id { get; set; }           // Primary key
    public string Name { get; set; }      // Product name
    public string Description { get; set; } // Product description
    public decimal Price { get; set; }    // Product price
    public int Stock { get; set; }        // Available stock
    public string Category { get; set; }  // Product category
    
    // Timestamps
    public DateTime CreatedDate { get; set; }
    public DateTime UpdatedDate { get; set; }
    
    // Navigation property (for relationships)
    public ICollection&lt;OrderItem&gt; OrderItems { get; set; }
}

// Database Context - Represents the database
public class ApplicationDbContext : DbContext
{
    public ApplicationDbContext(DbContextOptions<ApplicationDbContext> options)
        : base(options)
    {
    }
    
    // DbSet represents a database table
    public DbSet&lt;Product&gt; Products { get; set; }
    public DbSet&lt;Order&gt; Orders { get; set; }
    public DbSet&lt;OrderItem&gt; OrderItems { get; set; }
}</code></pre>
            </div>
        </div>
    </div>

    <div class="comparison-section">
        <h2>Good vs Bad Repository Patterns</h2>
        
        <div class="comparison-grid">
            <div class="comparison-item good">
                <h4><i class="fas fa-check-circle"></i> Good Repository</h4>
                <ul>
                    <li>Only does database operations</li>
                    <li>Simple, focused methods</li>
                    <li>Uses interfaces for flexibility</li>
                    <li>No business logic</li>
                    <li>Easy to test and mock</li>
                </ul>
            </div>
            
            <div class="comparison-item bad">
                <h4><i class="fas fa-times-circle"></i> Bad Repository</h4>
                <ul>
                    <li>Contains business logic</li>
                    <li>Mixes database operations with calculations</li>
                    <li>Hardcoded configuration values</li>
                    <li>Directly called from controllers</li>
                    <li>Difficult to test</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="interactive-exercise">
        <h2><i class="fas fa-gamepad"></i> Repository in Action: The Full Flow</h2>
        <p>Let's trace what happens when a user wants to add a product to their cart:</p>
        
        <div class="flow-container">
            <div class="flow-step">
                <div class="flow-number">1</div>
                <div class="flow-content">
                    <h5>User Clicks "Add to Cart"</h5>
                    <p>Sends <code>POST /cart/add/5</code> request</p>
                </div>
                <div class="flow-arrow">↓</div>
            </div>
            
            <div class="flow-step">
                <div class="flow-number">2</div>
                <div class="flow-content">
                    <h5>Controller Validates</h5>
                    <p><code>CartController.AddToCart(5)</code> checks user is logged in</p>
                </div>
                <div class="flow-arrow">↓</div>
            </div>
            
            <div class="flow-step">
                <div class="flow-number">3</div>
                <div class="flow-content">
                    <h5>Service Does Logic</h5>
                    <p><code>CartService.AddToCart(5, userId)</code> checks business rules:
                        <ul>
                            <li>Is product in stock?</li>
                            <li>Is user allowed to purchase?</li>
                        </ul>
                    </p>
                </div>
                <div class="flow-arrow">↓</div>
            </div>
            
            <div class="flow-step highlight">
                <div class="flow-number">4</div>
                <div class="flow-content">
                    <h5>Repository Fetches Data</h5>
                    <p><code>ProductRepository.GetById(5)</code> gets product from database</p>
                    <div class="code-snippet">
                        <strong>SQL Generated:</strong> <code>SELECT * FROM Products WHERE Id = 5</code>
                    </div>
                </div>
                <div class="flow-arrow">↑</div>
            </div>
            
            <div class="flow-step">
                <div class="flow-number">5</div>
                <div class="flow-content">
                    <h5>Service Processes</h5>
                    <p>Service creates cart item, calculates totals</p>
                </div>
                <div class="flow-arrow">↓</div>
            </div>
            
            <div class="flow-step highlight">
                <div class="flow-number">6</div>
                <div class="flow-content">
                    <h5>Repository Saves Data</h5>
                    <p><code>CartRepository.Add(cartItem)</code> saves to database</p>
                    <div class="code-snippet">
                        <strong>SQL Generated:</strong> <code>INSERT INTO CartItems VALUES (...)</code>
                    </div>
                </div>
                <div class="flow-arrow">↑</div>
            </div>
            
            <div class="flow-step">
                <div class="flow-number">7</div>
                <div class="flow-content">
                    <h5>Service Returns</h5>
                    <p>Returns success message to controller</p>
                </div>
                <div class="flow-arrow">↑</div>
            </div>
            
            <div class="flow-step">
                <div class="flow-number">8</div>
                <div class="flow-content">
                    <h5>Controller Redirects</h5>
                    <p>Sends user to cart page with success message</p>
                </div>
                <div class="flow-arrow">↑</div>
            </div>
            
            <div class="flow-step">
                <div class="flow-number">9</div>
                <div class="flow-content">
                    <h5>User Sees Result</h5>
                    <p>Cart page shows item was added successfully!</p>
                </div>
            </div>
        </div>
    </div>

    <div class="advanced-concepts">
        <h2><i class="fas fa-rocket"></i> Advanced Repository Patterns</h2>
        
        <div class="pattern-grid">
            <div class="pattern-item">
                <div class="pattern-icon">
                    <i class="fas fa-layer-group"></i>
                </div>
                <h4>Generic Repository</h4>
                <p>Create one repository that works for all entities:</p>
<pre><code class="language-csharp">public interface IRepository&lt;T&gt; where T : class
{
    T GetById(int id);
    IEnumerable&lt;T&gt; GetAll();
    void Add(T entity);
    void Update(T entity);
    void Delete(T entity);
}</code></pre>
            </div>
            
            <div class="pattern-item">
                <div class="pattern-icon">
                    <i class="fas fa-cogs"></i>
                </div>
                <h4>Unit of Work</h4>
                <p>Group multiple operations into one transaction:</p>
<pre><code class="language-csharp">public interface IUnitOfWork : IDisposable
{
    IProductRepository Products { get; }
    IOrderRepository Orders { get; }
    ICartRepository Carts { get; }
    
    int Complete(); // Save all changes
}</code></pre>
            </div>
            
            <div class="pattern-item">
                <div class="pattern-icon">
                    <i class="fas fa-search-plus"></i>
                </div>
                <h4>Specification Pattern</h4>
                <p>Build complex queries in a reusable way:</p>
<pre><code class="language-csharp">public class InStockSpecification
{
    public Expression&lt;Func&lt;Product, bool&gt;&gt; ToExpression()
    {
        return p => p.Stock > 0;
    }
}

// Usage:
var inStockProducts = repository
    .Find(new InStockSpecification());</code></pre>
            </div>
        </div>
    </div>

    <div class="key-principles">
        <h2><i class="fas fa-key"></i> Repository Key Principles</h2>
        
        <div class="principles-grid">
            <div class="principle-item">
                <div class="principle-icon">
                    <i class="fas fa-database"></i>
                </div>
                <h5>Only Database Access</h5>
                <p>Repositories should only contain code that talks to the database. No business logic, no calculations, just data access.</p>
            </div>
            
            <div class="principle-item">
                <div class="principle-icon">
                    <i class="fas fa-exchange-alt"></i>
                </div>
                <h5>Interface-Based</h5>
                <p>Always use interfaces. This allows for easy testing, swapping implementations, and following the Dependency Inversion Principle.</p>
            </div>
            
            <div class="principle-item">
                <div class="principle-icon">
                    <i class="fas fa-snowflake"></i>
                </div>
                <h5>Keep It Simple</h5>
                <p>Repository methods should be simple and focused. If a method is getting complex, it probably belongs in the Service Layer.</p>
            </div>
            
            <div class="principle-item">
                <div class="principle-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h5>No Business Logic</h5>
                <p>Never put business rules in repositories. They should be "dumb" data access objects that just get and save data.</p>
            </div>
        </div>
    </div>

    <div class="quiz-section">
        <h3><i class="fas fa-brain"></i> Quick Check: Repository Knowledge</h3>
        <div class="quiz-question">
            <p><strong>Question:</strong> Which of these belongs in a Repository?</p>
            
            <div class="quiz-options">
                <button class="quiz-option" data-correct="true">
                    <i class="fas fa-database"></i> Get all products from database
                </button>
                <button class="quiz-option" data-correct="false">
                    <i class="fas fa-percentage"></i> Calculate 20% discount for sales
                </button>
                <button class="quiz-option" data-correct="true">
                    <i class="fas fa-save"></i> Save new user to database
                </button>
                <button class="quiz-option" data-correct="false">
                    <i class="fas fa-user-check"></i> Check if user is eligible for discount
                </button>
            </div>
            
            <div class="quiz-feedback">
                <p id="quiz-feedback-text"></p>
            </div>
        </div>
    </div>

    <div class="real-world-tip">
        <h3><i class="fas fa-lightbulb"></i> Real-World Tip</h3>
        <p><strong>Think of repositories as "database translators"</strong>. They take simple requests like "get product #5" and translate them into database queries. They don't know or care WHY you need the product - they just fetch it.</p>
        <p>This separation is crucial when you need to change databases (like moving from SQL Server to PostgreSQL) or when testing (using a mock database).</p>
    </div>

    <div class="navigation-buttons">
        <a href="@Url.Action("ControllerLayer", "AdvancedWebApp")" class="btn btn-outline-primary ajax-link" data-path="/AdvancedWebApp/ControllerLayer">← Back: Controller Layer</a>
        <a href="@Url.Action("ServiceLayer", "AdvancedWebApp")" class="btn btn-primary ajax-link" data-path="/AdvancedWebApp/ServiceLayer">Next: Service Layer →</a>
    </div>
</div>

<style>
    .container { 
        max-width: 900px; 
        padding: 20px; 
        background-color: var(--bs-body-bg); 
    }
    
    h1, h2, h3, h4, h5 { 
        color: var(--bs-heading-color); 
        margin-bottom: 15px; 
    }
    
    h1 { 
        border-bottom: 2px solid var(--bs-info); 
        padding-bottom: 10px; 
    }
    
    .beginner-note {
        background-color: rgba(23, 162, 184, 0.1);
        border: 2px solid var(--bs-info);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 30px;
        display: flex;
        gap: 15px;
        align-items: flex-start;
    }
    
    .beginner-note-icon {
        background-color: var(--bs-info);
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        flex-shrink: 0;
    }
    
    .important-note {
        background-color: rgba(255, 193, 7, 0.2);
        border: 2px solid var(--bs-warning);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 30px;
    }
    
    .intro-section {
        margin-bottom: 40px;
    }
    
    .repository-tasks {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .task-card {
        text-align: center;
        padding: 20px;
        background-color: rgba(23, 162, 184, 0.1);
        border-radius: 8px;
        border: 1px solid rgba(23, 162, 184, 0.3);
    }
    
    .task-icon {
        font-size: 2rem;
        color: var(--bs-info);
        margin-bottom: 10px;
    }
    
    .code-section {
        margin: 40px 0;
    }
    
    .example-tabs {
        display: flex;
        gap: 5px;
        margin-bottom: 20px;
        border-bottom: 2px solid var(--bs-border-color);
        padding-bottom: 10px;
    }
    
    .example-tab {
        padding: 10px 20px;
        background-color: rgba(0, 0, 0, 0.1);
        border: none;
        border-radius: 4px;
        color: var(--bs-body-color);
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .example-tab.active {
        background-color: var(--bs-info);
        color: white;
    }
    
    .tab-content {
        display: none;
        background-color: #1a1a1a;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 20px;
    }
    
    .tab-content.active {
        display: block;
    }
    
    .code-explanation {
        padding: 15px;
        background-color: #2d2d2d;
        border-bottom: 1px solid #444;
    }
    
    .code-explanation h5 {
        display: flex;
        align-items: center;
        gap: 10px;
        color: var(--bs-info);
    }
    
    .code-explanation ul {
        margin: 10px 0;
        padding-left: 20px;
    }
    
    .comparison-section {
        margin: 40px 0;
    }
    
    .comparison-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 20px;
    }
    
    @@media (max-width: 768px) {
        .comparison-grid {
            grid-template-columns: 1fr;
        }
    }
    
    .comparison-item {
        padding: 20px;
        border-radius: 8px;
    }
    
    .comparison-item.good {
        background-color: rgba(40, 167, 69, 0.1);
        border: 1px solid var(--bs-success);
    }
    
    .comparison-item.bad {
        background-color: rgba(220, 53, 69, 0.1);
        border: 1px solid var(--bs-danger);
    }
    
    .comparison-item ul {
        margin: 15px 0 0 0;
        padding-left: 20px;
    }
    
    .comparison-item li {
        margin-bottom: 8px;
        position: relative;
        padding-left: 25px;
    }
    
    .comparison-item.good li:before {
        content: "✓";
        position: absolute;
        left: 0;
        color: var(--bs-success);
        font-weight: bold;
    }
    
    .comparison-item.bad li:before {
        content: "✗";
        position: absolute;
        left: 0;
        color: var(--bs-danger);
        font-weight: bold;
    }
    
    .interactive-exercise {
        margin: 40px 0;
        padding: 25px;
        background-color: rgba(111, 66, 193, 0.1);
        border: 1px solid var(--bs-indigo);
        border-radius: 10px;
    }
    
    .flow-container {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-top: 20px;
        position: relative;
    }
    
    .flow-container:before {
        content: '';
        position: absolute;
        left: 30px;
        top: 0;
        bottom: 0;
        width: 2px;
        background-color: var(--bs-info);
        z-index: 1;
    }
    
    .flow-step {
        display: flex;
        align-items: center;
        gap: 20px;
        padding: 15px;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        position: relative;
        z-index: 2;
    }
    
    .flow-step.highlight {
        background-color: rgba(23, 162, 184, 0.2);
        border: 2px solid var(--bs-info);
    }
    
    .flow-number {
        background-color: var(--bs-info);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.2rem;
        flex-shrink: 0;
    }
    
    .flow-step.highlight .flow-number {
        background-color: var(--bs-warning);
        color: var(--bs-dark);
    }
    
    .flow-content {
        flex: 1;
    }
    
    .flow-content ul {
        margin: 10px 0 0 0;
        padding-left: 20px;
    }
    
    .code-snippet {
        margin-top: 10px;
        padding: 10px;
        background-color: rgba(0, 0, 0, 0.3);
        border-radius: 4px;
        font-family: monospace;
        font-size: 0.9rem;
    }
    
    .flow-arrow {
        color: var(--bs-info);
        font-size: 1.5rem;
        font-weight: bold;
        flex-shrink: 0;
    }
    
    .advanced-concepts {
        margin: 40px 0;
    }
    
    .pattern-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .pattern-item {
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        border: 1px solid var(--bs-secondary);
    }
    
    .pattern-icon {
        font-size: 2rem;
        color: var(--bs-primary);
        margin-bottom: 15px;
        text-align: center;
    }
    
    .key-principles {
        margin: 40px 0;
        padding: 25px;
        background-color: rgba(40, 167, 69, 0.1);
        border: 1px solid var(--bs-success);
        border-radius: 10px;
    }
    
    .principles-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .principle-item {
        text-align: center;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
    }
    
    .principle-icon {
        background-color: var(--bs-success);
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        margin: 0 auto 15px;
    }
    
    .quiz-section {
        margin: 40px 0;
        padding: 25px;
        background-color: rgba(255, 193, 7, 0.1);
        border: 1px solid var(--bs-warning);
        border-radius: 10px;
    }
    
    .quiz-question {
        margin-top: 20px;
    }
    
    .quiz-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin: 20px 0;
    }
    
    @@media (max-width: 768px) {
        .quiz-options {
            grid-template-columns: 1fr;
        }
    }
    
    .quiz-option {
        padding: 15px;
        background-color: rgba(0, 0, 0, 0.2);
        border: 2px solid var(--bs-secondary);
        border-radius: 8px;
        color: var(--bs-body-color);
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 10px;
        text-align: left;
    }
    
    .quiz-option:hover {
        background-color: rgba(0, 0, 0, 0.3);
        transform: translateY(-2px);
    }
    
    .quiz-option.correct {
        background-color: rgba(40, 167, 69, 0.3);
        border-color: var(--bs-success);
    }
    
    .quiz-option.incorrect {
        background-color: rgba(220, 53, 69, 0.3);
        border-color: var(--bs-danger);
    }
    
    .quiz-option.selected {
        border-width: 3px;
    }
    
    .quiz-feedback {
        padding: 15px;
        background-color: rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        display: none;
    }
    
    .quiz-feedback.show {
        display: block;
        animation: fadeIn 0.5s;
    }
    
    .real-world-tip {
        margin: 40px 0;
        padding: 25px;
        background-color: rgba(108, 117, 125, 0.1);
        border: 1px solid var(--bs-secondary);
        border-radius: 10px;
    }
    
    .real-world-tip h3 {
        display: flex;
        align-items: center;
        gap: 10px;
        color: var(--bs-warning);
    }
    
    .navigation-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 40px;
        padding-top: 20px;
        border-top: 2px solid var(--bs-border-color);
    }
    
    .btn {
        padding: 12px 25px;
        border-radius: 6px;
        font-weight: 500;
        transition: all 0.3s;
    }
    
    .btn:hover {
        transform: translateY(-2px);
    }
    
    @@media (max-width: 768px) {
        .beginner-note {
            flex-direction: column;
            text-align: center;
        }
        
        .flow-container:before {
            left: 50%;
            transform: translateX(-50%);
        }
        
        .flow-step {
            flex-direction: column;
            text-align: center;
        }
        
        .flow-arrow {
            transform: rotate(90deg);
        }
        
        .navigation-buttons {
            flex-direction: column;
            gap: 10px;
        }
        
        .navigation-buttons .btn {
            width: 100%;
            text-align: center;
        }
    }
</style>

<script>
$(document).ready(function() {
    // Initialize syntax highlighting
    if (typeof hljs !== 'undefined') {
        hljs.highlightAll();
    }
    
    // Tab functionality for code examples
    $('.example-tab').click(function() {
        const target = $(this).data('target');
        
        // Update active tab
        $('.example-tab').removeClass('active');
        $(this).addClass('active');
        
        // Show corresponding content
        $('.tab-content').removeClass('active');
        $(`#${target}-tab`).addClass('active');
    });
    
    // Quiz functionality
    $('.quiz-option').click(function() {
        const $this = $(this);
        const isCorrect = $this.data('correct') === true;
        
        // Reset all options
        $('.quiz-option').removeClass('correct incorrect selected');
        
        // Mark this option as selected
        $this.addClass('selected');
        
        // Mark correct/incorrect
        $this.addClass(isCorrect ? 'correct' : 'incorrect');

        let feedbackText;
        if (isCorrect) {
            feedbackText = 'Correct! Database operations like fetching products and saving users belong in the Repository Layer. Business logic like calculating discounts or checking eligibility belongs in the Service Layer.';
        } else {
            feedbackText = 'Actually, business calculations and rules should NOT be in the Repository Layer. Repositories should only handle simple database operations - fetching, saving, updating, and deleting data.';
        }
        
        $('#quiz-feedback-text').text(feedbackText);
        $('.quiz-feedback').addClass('show');
    });

    const flowSteps = $('.flow-step');
    flowSteps.each(function(index) {
        $(this).css({
            'opacity': '0',
            'transform': 'translateY(20px)',
            'transition': 'all 0.5s ease ' + (index * 0.1) + 's'
        });
    });
    
    setTimeout(() => {
        flowSteps.each(function() {
            $(this).css({
                'opacity': '1',
                'transform': 'translateY(0)'
            });
        });
    }, 300);

    $('.navigation-buttons a').addClass('ajax-link');
});
</script>