@{
    ViewData["Title"] = "Променливи";
}

<div class="container">
    <h1 class="mb-4">Променливи: Чување информации во програми</h1>

    <p><strong>Променливи</strong> се основни градбени блокови на програмирањето. Тие функционираат како <strong>означени контејнери</strong> кои чуваат податоци што вашата програма треба да ги користи. Замислете ги како кутии со имиња каде можете да складирате различни типови информации.</p>

    <p>Променливи користите секојдневно без да знаете:</p>
    <ul>
        <li>Вашата <strong>возраст</strong> е бројна променлива</li>
        <li>Вашето <strong>име</strong> е текстуална променлива</li>
        <li>Дали сте <strong>најавени</strong> е логичка (true/false) променлива</li>
        <li>Вашиот <strong>тест резултат</strong> е бројна променлива</li>
    </ul>

    <h2>Што е променлива?</h2>
    <p>Променливата има три основни делови:</p>

    <div class="code-container">
        <div class="code-header">Анатомија на променлива</div>
        <div class="code-content">
<pre>
         Тип на податок     Име на променлива     Вредност
            ↓               ↓                     ↓
            <strong>int</strong>           <strong>age</strong>          =     <strong>25</strong>;
            <strong>string</strong>        <strong>name</strong>         =     <strong>"Sarah"</strong>;
            <strong>bool</strong>         <strong>isStudent</strong>    =     <strong>true</strong>;
</pre>
        </div>
    </div>

    <p>Замислете го вака:</p>
    <ul>
        <li><strong>Тип на податок</strong> → Каков вид контејнер е тоа? (кутија за број, кутија за текст, Да/Не кутија)</li>
        <li><strong>Име на променлива</strong> → Ознаката на контејнерот</li>
        <li><strong>Вредност</strong> → Што всушност се наоѓа внатре во контејнерот</li>
    </ul>

    <h2>Чести типови на податоци</h2>

    <div class="code-container">
        <div class="code-header">Основни типови на променливи</div>
        <div class="code-content">
<pre>
<strong>int</strong>       →       Чува цели броеви<code>15</code> <code>-3</code> <code>1000</code>
<strong>float</strong>     →       Чува децимални броеви<code>3.14</code> <code>1.5</code> <code>99.9</code>
<strong>char</strong>      →       Чува еден карактер<code>'A'</code> <code>'$'</code> <code>'7'</code>
<strong>string</strong>    →       Чува текст<code>"Hello"</code> <code>"John"</code> <code>"C# Rules!"</code>
<strong>bool</strong>      →       Чува логички вредности<code>true</code> <code>false</code>
</pre>
        </div>
    </div>

    <h2>Пример 1: Основно создавање на променливи</h2>
    <p>Креирање и користење едноставни променливи:</p>

    <div class="code-container">
        <div class="form-check form-switch mb-2">
            <input class="form-check-input" type="checkbox" id="example1Toggle" onchange="window.convertCode('example1')">
            <label class="form-check-label" for="example1Toggle">Претвори во C#</label>
        </div>
        <div class="code-content">
<pre class="codeBlock" id="example1Code">
// Креирање на променливи
int age = 15;
float height = 1.65;
string name = "Alex";
bool isStudent = true;
char grade = 'A';

// Користење на променливи
cout << "Име: " << name << endl;
cout << "Возраст: " << age << " години" << endl;
cout << "Висина: " << height << " метри" << endl;
cout << "Студент: " << (isStudent ? "Да" : "Не") << endl;
cout << "Оценка: " << grade << endl;
</pre>
        </div>
        <div class="result-box" id="example1Result">
             <strong>Резултат:</strong><br>Име: Alex<br>Возраст: 15 години<br>Висина: 1.65 метри<br>Студент: Да<br>Оценка: A<br>
            <em>Објаснување:</em> Секоја променлива чува различен тип на податок. Потоа ги користиме овие променливи за прикажување информации.
        </div>
    </div>

    <h2>Пример 2: Операции со променливи</h2>
    <p>Променливите можат да се користат во пресметки и операции:</p>

    <div class="code-container">
        <div class="form-check form-switch mb-2">
            <input class="form-check-input" type="checkbox" id="example2Toggle" onchange="window.convertCode('example2')">
            <label class="form-check-label" for="example2Toggle">Претвори во C#</label>
        </div>
        <div class="code-content">
<pre class="codeBlock" id="example2Code">
int apples = 5;
int oranges = 3;

// Основни аритметички операции со променливи
int totalFruits = apples + oranges;
int difference = apples - oranges;
int doubleApples = apples * 2;

cout << "Јаболка: " << apples << endl;
cout << "Портокали: " << oranges << endl;
cout << "Вкупно овошје: " << totalFruits << endl;
cout << "Повеќе јаболка од портокали: " << difference << endl;
cout << "Дупло јаболка: " << doubleApples << endl;
</pre>
        </div>
        <div class="result-box" id="example2Result">
             <strong>Резултат:</strong><br>Јаболка: 5<br>Портокали: 3<br>Вкупно овошје: 8<br>Повеќе јаболка од портокали: 2<br>Дупло јаболка: 10<br>
            <em>Објаснување:</em> Променливите можат да се користат во математички операции исто како обични броеви. Компјутерот користи вредности зачувани во променливите.
        </div>
    </div>

    <h2>Пример 3: Промена на вредности на променливи</h2>
    <p>Променливите се нарекуваат „променливи“ бидејќи нивните вредности можат да <strong>се менуваат</strong>:</p>

    <div class="code-container">
        <div class="form-check form-switch mb-2">
            <input class="form-check-input" type="checkbox" id="example3Toggle" onchange="window.convertCode('example3')">
            <label class="form-check-label" for="example3Toggle">Претвори во C#</label>
        </div>
        <div class="code-content">
<pre class="codeBlock" id="example3Code">
int counter = 0;
cout << "Бројач започнува на: " << counter << endl;

// Промена на вредноста
counter = 10;
cout << "Бројач променет на: " << counter << endl;

// Зголемување за 5
counter = counter + 5;  // Исто како: counter += 5
cout << "Бројач зголемен на: " << counter << endl;

// Намалување за 3
counter = counter - 3;  // Исто како: counter -= 3
cout << "Бројач намален на: " << counter << endl;

// Множење со 2
counter = counter * 2;  // Исто како: counter *= 2
cout << "Бројач двојно: " << counter << endl;
</pre>
        </div>
        <div class="result-box" id="example3Result">
             <strong>Резултат:</strong><br>Бројач започнува на: 0<br>Бројач променет на: 10<br>Бројач зголемен на: 15<br>Бројач намален на: 12<br>Бројач двојно: 24<br>
            <em>Објаснување:</em> Можете да ја промените вредноста на променлива во секое време. Новата вредност го заменува старата. Специјални оператори како <code>+=</code> и <code>-=</code> даваат кратки начини за чести операции.
        </div>
    </div>

    <h2>Пример 4: Операции со текст (strings)</h2>
    <p>Текстуалните променливи можат да се комбинираат и модифицираат:</p>

    <div class="code-container">
        <div class="form-check form-switch mb-2">
            <input class="form-check-input" type="checkbox" id="example4Toggle" onchange="window.convertCode('example4')">
            <label class="form-check-label" for="example4Toggle">Претвори во C#</label>
        </div>
        <div class="code-content">
<pre class="codeBlock" id="example4Code">
string firstName = "John";
string lastName = "Smith";
int age = 25;

// Комбинирање на текст (concatenation)
string fullName = firstName + " " + lastName;
cout << "Целосно име: " << fullName << endl;

// Креирање пораки со променливи
string greeting = "Hello, " + firstName + "!";
string info = firstName + " има " + to_string(age) + " години.";

cout << greeting << endl;
cout << info << endl;

// Промена на текст
firstName = "Jonathan";
cout << "Ново име: " << firstName << endl;
</pre>
        </div>
        <div class="result-box" id="example4Result">
             <strong>Резултат:</strong><br>Целосно име: John Smith<br>Hello, John!<br>John има 25 години.<br>Ново име: Jonathan<br>
            <em>Објаснување:</em> Текстот може да се комбинира со <code>+</code> (concatenation). Кога комбинирате текст со број, бројот мора да се конвертира во текст.
        </div>
    </div>

    <h2>Пример 5: Реална примена – Игра</h2>
    <p>Променливите се клучни за следење информации во игра:</p>

    <div class="code-container">
        <div class="form-check form-switch mb-2">
            <input class="form-check-input" type="checkbox" id="example5Toggle" onchange="window.convertCode('example5')">
            <label class="form-check-label" for="example5Toggle">Претвори во C#</label>
        </div>
        <div class="code-content">
<pre class="codeBlock" id="example5Code">
string playerName = "GameMaster";
int health = 100;
int score = 0;
float speed = 5.5;
bool isAlive = true;

cout << "=== СТАТИСТИКА НА ИГРАЧ ===" << endl;
cout << "Играч: " << playerName << endl;
cout << "Здравје: " << health << endl;
cout << "Резултат: " << score << endl;
cout << "Брзина: " << speed << endl;
cout << "Жив: " << (isAlive ? "Да" : "Не") << endl;

// Дејства во игра
score = score + 50;      // Играчот заработи поени
health = health - 20;    // Играчот прими штета

cout << "\n=== ПО ДЕЈСТВО ===" << endl;
cout << "Нов резултат: " << score << endl;
cout << "Ново здравје: " << health << endl;

if (health <= 0) {
    isAlive = false;
    cout << "Играчот е поразен!" << endl;
}
</pre>
        </div>
        <div class="result-box" id="example5Result">
             <strong>Резултат:</strong><br>=== СТАТИСТИКА НА ИГРАЧ ===<br>Играч: GameMaster<br>Здравје: 100<br>Резултат: 0<br>Брзина: 5.5<br>Жив: Да<br><br>=== ПО ДЕЈСТВО ===<br>Нов резултат: 50<br>Ново здравје: 80<br>
            <em>Објаснување:</em> Игрите користат променливи за следење на состојбата на играчот. Вредностите се менуваат според случувањата во играта.
        </div>
    </div>

    <h2>Пример 6: Конвертер на температура</h2>
    <p>Практичен пример со променливи за конверзија на единици:</p>

    <div class="code-container">
        <div class="form-check form-switch mb-2">
            <input class="form-check-input" type="checkbox" id="example6Toggle" onchange="window.convertCode('example6')">
            <label class="form-check-label" for="example6Toggle">Претвори во C#</label>
        </div>
        <div class="code-content">
<pre class="codeBlock" id="example6Code">
float celsius = 25.0;
float fahrenheit;

// Конверзија од Целзиус во Фаренхајт
fahrenheit = (celsius * 9.0 / 5.0) + 32.0;

cout << "Конвертер на температура" << endl;
cout << "====================" << endl;
cout << celsius << "°C = " << fahrenheit << "°F" << endl;

// Конвертирање назад
celsius = (fahrenheit - 32.0) * 5.0 / 9.0;
cout << fahrenheit << "°F = " << celsius << "°C" << endl;
</pre>
        </div>
        <div class="result-box" id="example6Result">
             <strong>Резултат:</strong><br>Конвертер на температура<br>====================<br>25°C = 77°F<br>77°F = 25°C<br>
            <em>Објаснување:</em> Променливите чуваат вредности на температурата, а математички формули ја извршуваат конверзијата. Иста променлива (<code>celsius</code>) може да се користи со нова вредност.
        </div>
    </div>

    <h2>Чести грешки</h2>
    <div class="code-container">
        <div class="code-header">Грешки и решенија</div>
        <div class="code-content">
<pre>
// <span style="color:red"> ГРЕШНО: Користење на променлива пред да се инициализира </span>>
int count;
cout << count;  // ERROR: Каква е вредноста?

// <span style="color:lightgreen"> ТОЧНО: Иницијализација пред користење </span>>
int count = 0;
cout << count;  // Вредноста е 0

// <span style="color:red"> ГРЕШНО: Погрешен тип на вредност </span>>
int price = 19.99;  // ERROR: 19.99 не е цел број

//  <span style="color:lightgreen"> ТОЧНО: Користење на соодветен тип </span>>
float price = 19.99;  // GOOD: float за децимали

// <span style="color:red"> ГРЕШНО: Погрешни кавички за char </span>>
char letter = "A";  // ERROR: "A" е string, 'A' е char

//  <span style="color:lightgreen"> ТОЧНО: Користење на единични кавички </span>>
char letter = 'A';  // GOOD: char користи ' '

// <span style="color:red"> ГРЕШНО: Користење резервирани зборови како име </span>>
int int = 5;  // ERROR: 'int' е резервиран збор

// <span style="color:lightgreen"> ТОЧНО: Користење описни имиња </span>>
int score = 5;  // GOOD: Јасно и дозволено
</pre>
        </div>
    </div>

    <h2>Визуелна претстава: Променливи во меморија</h2>

    <div class="code-container">
        <div class="code-header">Мемориска претстава</div>
        <div class="code-content">
<pre>
Код:         int age = 25;
              string name = "Alice";

Меморија:
Адреса      Променлива    Вредност
1000        age           25
1004        name          "Alice"

Кога користите 'age' во код:
- Компјутерот бара променлива со име 'age'
- Ја наоѓа на адреса 1000
- Го зема вредноста 25
- Ја користи во пресметки или за прикажување
</pre>
        </div>
    </div>

    <h2>Правила за именување & Добри практики</h2>
    <div class="code-container">
        <div class="code-header">Добри и лоши имиња на променливи</div>
        <div class="code-content">
<pre>
//  ДОБРИ ИМЕНОВИ: Јасни и описни
int studentCount = 30;
float averageScore = 85.5;
string userName = "player123";
bool isGameOver = false;

//  ЛОШИ ИМЕНОВИ: Нејасни или збунувачки
int x = 30;              // Што претставува x?
float asdf = 85.5;       // Без значење
string n = "player123";  // Превише кратко
bool b = false;          // Неописно

//  ПРАВИЛА:
// 1. Почнувајте со буква или подвлечен знак
// 2. Може да содржи букви, броеви, подвлечени знаци
// 3. Големите и малите букви се различни (age ≠ Age ≠ AGE)
// 4. Не користете резервирани зборови (int, if, for, итн.)
// 5. Користете camelCase за повеќедумни имиња
</pre>
        </div>
    </div>

    <h2>Резиме</h2>
    <ul>
        <li><strong>Променливи</strong> се контејнери кои чуваат податоци во програмата</li>
        <li>Секоја променлива има <strong>тип</strong> (int, float, string, bool, char)</li>
        <li>Променливите мора да се <strong>декларираат</strong> пред користење</li>
        <li>Можете да им <strong>доделите вредности</strong> со <code>=</code></li>
        <li>Вредностите на променливите можат да <strong>се менуваат</strong> низ програмата</li>
        <li>Користете <strong>описни имиња</strong> кои објаснуваат што чува променливата</li>
        <li>Променливите се клучни за чување на кориснички внес, резултати од пресметки, состојби во игри и многу повеќе</li>
    </ul>

    <div class="navigation-buttons">
        <a href="@Url.Action("Index", "Introduction")" class="btn btn-outline-primary ajax-link">← Вовед</a>
        <a href="@Url.Action("InputOutput", "SP")" class="btn btn-primary ajax-link">Внесување и Излез →</a>
    </div>
</div>

<style>
    .container {
        max-width: 800px;
        padding: 20px;
        background-color: var(--bs-body-bg);
    }

    h1, h2 {
        color: var(--bs-heading-color);
        margin-bottom: 15px;
    }

    p, li, code {
        color: var(--bs-body-color);
        line-height: 1.6;
    }

    .code-container {
        margin: 25px 0;
        border: 1px solid var(--bs-border-color);
        border-radius: 5px;
        overflow: hidden;
        background-color: var(--code-bg);
    }

    .code-header {
        background-color: var(--code-header-bg);
        padding: 10px 15px;
        border-bottom: 1px solid var(--bs-border-color);
        font-family: 'SFMono-Regular', Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        font-size: 0.9rem;
        color: var(--bs-body-color);
    }

    .code-content {
        padding: 15px;
        overflow-x: auto;
    }

    pre {
        margin: 0;
        white-space: pre-wrap;
        background-color: transparent;
        font-family: 'SFMono-Regular', Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .result-box {
        padding: 10px 15px;
        background-color: rgba(0, 123, 255, 0.1);
        border-top: 1px solid var(--bs-border-color);
        font-size: 0.95rem;
    }

    .fade {
        opacity: 0;
        transition: opacity 0.25s ease;
    }

    .navigation-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 30px;
    }

    .btn {
        padding: 8px 20px;
        border-radius: 4px;
        font-weight: 500;
        text-decoration: none;
    }

    .btn-primary {
        background-color: var(--bs-primary);
        border-color: var(--bs-primary);
        color: #fff;
    }

    .btn-outline-primary {
        color: var(--bs-primary);
        border-color: var(--bs-primary);
        background-color: transparent;
    }
</style>

<script>
// Make all functions and data available globally
window.fullCodeLines = [
    'int score = 85;',
    'int bonus = 15;',
    'int total = score + bonus; // ⬅ Run Code Block',
    'cout << "Total: " << total << endl;'
];

window.traceSteps = [
    { line: 0, vars: 'score = 85, bonus = ?, total = ?', exp: 'Creates variable <code>score</code> and assigns it the value 85.' },
    { line: 1, vars: 'score = 85, bonus = 15, total = ?', exp: 'Creates variable <code>bonus</code> and assigns it the value 15.' },
    { line: 2, vars: 'score = 85, bonus = 15, total = 100', exp: 'Creates variable <code>total</code> and calculates its value: <code>85 + 15 = 100</code>.' },
    { line: 3, vars: 'score = 85, bonus = 15, total = 100', exp: 'Displays the result: "Total: 100".' }
];

window.cppSnippets = {
    example1: `// Создавање променливи
int age = 15;
float height = 1.65;
string name = "Alex";
bool isStudent = true;
char grade = 'A';

// Користење променливи
cout << "Name: " << name << endl;
cout << "Age: " << age << " years" << endl;
cout << "Height: " << height << " meters" << endl;
cout << "Student: " << (isStudent ? "Yes" : "No") << endl;
cout << "Grade: " << grade << endl;`,
    example2: `int apples = 5;
int oranges = 3;

// Проста аритметика со променливи
int totalFruits = apples + oranges;
int difference = apples - oranges;
int doubleApples = apples * 2;

cout << "Apples: " << apples << endl;
cout << "Oranges: " << oranges << endl;
cout << "Total fruits: " << totalFruits << endl;
cout << "More apples than oranges: " << difference << endl;
cout << "Double apples: " << doubleApples << endl;`,
    example3: `int counter = 0;
cout << "Counter starts at: " << counter << endl;

// Промени ја вредноста
counter = 10;
cout << "Counter changed to: " << counter << endl;

// Зголеми за 5
counter = counter + 5;  // Исто со: counter += 5
cout << "Counter increased to: " << counter << endl;

// Намали за 3
    counter = counter - 3;  // Исто со: counter -= 3
cout << "Counter decreased to: " << counter << endl;

// Помножи со 2
    counter = counter * 2;  // Исто со: counter *= 2
cout << "Counter doubled to: " << counter << endl;`,
    example4: `string firstName = "John";
string lastName = "Smith";
int age = 25;

    // Спојување string-ови (конкатенација)
string fullName = firstName + " " + lastName;
cout << "Full Name: " << fullName << endl;

// Создавање пораки со променливи
string greeting = "Hello, " + firstName + "!";
string info = firstName + " is " + to_string(age) + " years old.";

cout << greeting << endl;
cout << info << endl;

// Создавање на string
firstName = "Jonathan";
cout << "New first name: " << firstName << endl;`,
    example5: `string playerName = "GameMaster";
int health = 100;
int score = 0;
float speed = 5.5;
bool isAlive = true;

cout << "=== GAME STATS ===" << endl;
cout << "Player: " << playerName << endl;
cout << "Health: " << health << endl;
cout << "Score: " << score << endl;
cout << "Speed: " << speed << endl;
cout << "Alive: " << (isAlive ? "Yes" : "No") << endl;

// Акции на игра
score = score + 50;      // Играчот освои поени
health = health - 20;    // Играчот прима damage

cout << "\n=== AFTER ACTION ===" << endl;
cout << "New Score: " << score << endl;
cout << "New Health: " << health << endl;

if (health <= 0) {
    isAlive = false;
    cout << "Player has been defeated!" << endl;
}`,
    example6: `float celsius = 25.0;
float fahrenheit;

// Конвертирај целзиусови во фаренахјтови
fahrenheit = (celsius * 9.0 / 5.0) + 32.0;

cout << "Temperature Converter" << endl;
cout << "====================" << endl;
cout << celsius << "°C = " << fahrenheit << "°F" << endl;

// Сега да конвертираме назад
celsius = (fahrenheit - 32.0) * 5.0 / 9.0;
cout << fahrenheit << "°F = " << celsius << "°C" << endl;`
};

window.csharpSnippets = {
    example1: `// Создавање променливи
int age = 15;
float height = 1.65f;
string name = "Alex";
bool isStudent = true;
char grade = 'A';

// Користење на променливите
Console.WriteLine("Name: " + name);
Console.WriteLine("Age: " + age + " years");
Console.WriteLine("Height: " + height + " meters");
Console.WriteLine("Student: " + (isStudent ? "Yes" : "No"));
Console.WriteLine("Grade: " + grade);`,
    example2: `int apples = 5;
int oranges = 3;

// Проста аритметика со променливите
int totalFruits = apples + oranges;
int difference = apples - oranges;
int doubleApples = apples * 2;

Console.WriteLine("Apples: " + apples);
Console.WriteLine("Oranges: " + oranges);
Console.WriteLine("Total fruits: " + totalFruits);
Console.WriteLine("More apples than oranges: " + difference);
Console.WriteLine("Double apples: " + doubleApples);`,
    example3: `int counter = 0;
Console.WriteLine("Counter starts at: " + counter);

// Промени ја вредноста
counter = 10;
Console.WriteLine("Counter changed to: " + counter);

// Зголеми за 5
    counter = counter + 5;  // Исто со: counter += 5
Console.WriteLine("Counter increased to: " + counter);

// Намали за 3
    counter = counter - 3;  // Исто со: counter -= 3
Console.WriteLine("Counter decreased to: " + counter);

// Поможни со 2
    counter = counter * 2;  // Исто со: counter *= 2
Console.WriteLine("Counter doubled to: " + counter);`,
    example4: `string firstName = "John";
string lastName = "Smith";
int age = 25;

// Спојување string-ови (конкатенација)
string fullName = firstName + " " + lastName;
Console.WriteLine("Full Name: " + fullName);

// Создавање пораки со променливи
string greeting = "Hello, " + firstName + "!";
string info = firstName + " is " + age + " years old.";

Console.WriteLine(greeting);
Console.WriteLine(info);

// Создавање на string
firstName = "Jonathan";
Console.WriteLine("New first name: " + firstName);`,
    example5: `string playerName = "GameMaster";
int health = 100;
int score = 0;
float speed = 5.5f;
bool isAlive = true;

Console.WriteLine("=== GAME STATS ===");
Console.WriteLine("Player: " + playerName);
Console.WriteLine("Health: " + health);
Console.WriteLine("Score: " + score);
Console.WriteLine("Speed: " + speed);
Console.WriteLine("Alive: " + (isAlive ? "Yes" : "No"));

// Акции на играта
score = score + 50;      // Играчот освои поени
health = health - 20;    // Играчот прима damage

Console.WriteLine("\n=== AFTER ACTION ===");
Console.WriteLine("New Score: " + score);
Console.WriteLine("New Health: " + health);

if (health <= 0)
{
    isAlive = false;
    Console.WriteLine("Player has been defeated!");
}`,
    example6: `float celsius = 25.0f;
float fahrenheit;

// Конвертирај целзиусови во фаренахјтови
fahrenheit = (celsius * 9.0f / 5.0f) + 32.0f;

Console.WriteLine("Temperature Converter");
Console.WriteLine("====================");
Console.WriteLine(celsius + "°C = " + fahrenheit + "°F");

// Сега да конвертираме назад
celsius = (fahrenheit - 32.0f) * 5.0f / 9.0f;
Console.WriteLine(fahrenheit + "°F = " + celsius + "°C");`
};

// Function to convert code between C++ and C#
window.convertCode = function(id) {
    console.log("Converting code for:", id);
    const toggle = document.getElementById(id + "Toggle");
    const isCSharp = toggle ? toggle.checked : false;
    const codeBlock = document.getElementById(id + "Code");
    
    if (!codeBlock) {
        console.error("Code block not found for:", id);
        return;
    }
    
    codeBlock.classList.add("fade");
    setTimeout(() => {
        const newCode = isCSharp ? window.csharpSnippets[id] : window.cppSnippets[id];
        if (newCode) {
            codeBlock.textContent = newCode;
        }
        codeBlock.classList.remove("fade");
    }, 250);
};

// Function to update walkthrough
window.updateWalkthrough = function(step) {
    const walkthroughCodeBase = document.getElementById('walkthroughCodeBase');
    const walkthroughVariables = document.getElementById('walkthroughVariables');
    const walkthroughExplanation = document.getElementById('walkthroughExplanation');
    
    if (!walkthroughCodeBase || !walkthroughVariables || !walkthroughExplanation) return;
    
    const data = window.traceSteps[step];
    let codeContent = '';
    const activeLineIndex = data.line;
    
    window.fullCodeLines.forEach((line, index) => {
        if (index === activeLineIndex) {
            codeContent += `<span style="background-color: yellow; color: black;">${line.replace('// ⬅ Run Code Block', '⬅ ACTIVE')}</span>\n`;
        } else if (line.includes('// ⬅ Run Code Block')) {
            codeContent += `// ${line.replace('// ⬅ Run Code Block', '').trim()}\n`;
        } else if (index === 2 && activeLineIndex !== 2) {
            codeContent += `// ${line.trim()}\n`;
        } else if (index === 3 && activeLineIndex !== 3) {
            codeContent += `// ${line.trim()}\n`;
        } else if (index !== activeLineIndex) {
            codeContent += `${line}\n`;
        }
    });
    
    walkthroughCodeBase.innerHTML = codeContent;
    walkthroughVariables.textContent = data.vars;
    walkthroughExplanation.innerHTML = `<em>Explanation:</em> ${data.exp}`;
    
    if (step === window.traceSteps.length - 1) {
        walkthroughExplanation.innerHTML += '<br><strong>Trace finished! Output: "Total: 100"</strong>';
        const nextStepBtn = document.getElementById('nextStepBtn');
        if (nextStepBtn) {
            nextStepBtn.disabled = true;
        }
    }
};

window.nextStepHandler = function() {
    if (window.currentTraceStep < window.traceSteps.length) {
        if (typeof window.updateWalkthrough === 'function') {
            window.updateWalkthrough(window.currentTraceStep);
            window.currentTraceStep++;
        }
    }
};

function initializeCodeExamples() {
    console.log("Initializing Variables page code examples");
    for (let i = 1; i <= 6; i++) {
        const toggle = document.getElementById(`example${i}Toggle`);
        const codeBlock = document.getElementById(`example${i}Code`);
        if (toggle && codeBlock) {
            const isCSharp = toggle.checked;
            const newCode = isCSharp ? window.csharpSnippets[`example${i}`] : window.cppSnippets[`example${i}`];
            if (newCode) {
                codeBlock.textContent = newCode;
            }
        }
    }
}

function initializeWalkthrough() {
    console.log("Initializing Variables walkthrough");
    const nextStepBtn = document.getElementById('nextStepBtn');
    if (nextStepBtn) {
        window.currentTraceStep = 0;
        
        if (typeof window.updateWalkthrough === 'function') {
            window.updateWalkthrough(0);
            window.currentTraceStep = 1;
        }
        
        nextStepBtn.disabled = false;
    }
}

document.addEventListener('DOMContentLoaded', function() {
    console.log("DOM loaded, initializing Variables page");
    initializeCodeExamples();
    initializeWalkthrough();
});

if (document.readyState === 'complete' || document.readyState === 'interactive') {
    setTimeout(function() {
        console.log("Document ready, initializing Variables page");
        initializeCodeExamples();
        initializeWalkthrough();
    }, 100);
}

window.initializeVariablesPage = function() {
    console.log("Initializing Variables page via global function");
    initializeCodeExamples();
    initializeWalkthrough();
};
</script>