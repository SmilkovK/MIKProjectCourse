@{
    ViewData["Title"] = "Низи";
}

<div class="container" data-topic="arrays">
    <h1 class="mb-4">Низи: Складирање на повеќе вредности</h1>

    <p><strong>Низа</strong> е како редица од кутии каде што можеш да складираш повеќе вредности од ист тип на едно место. Наместо да креираш многу одделни променливи, можеш да користиш една низа за да ги чуваш сите податоци.</p>

    <h2>Што е низа?</h2>
    <p>Замисли ја низата како <strong>нумерирана листа</strong> или <strong>колекција од кутии</strong>, каде што секоја има позиција (наречена <strong>индекс</strong>). Во програмирањето, броењето најчесто започнува од <strong>0</strong>, а не од 1.</p>

    <div class="code-container">
        <div class="code-header">Визуелна претстава</div>
        <div class="code-content">
<pre>
Индекс:   [0]    [1]    [2]    [3]    [4]
Вредност:  10     20     30     40     50
Име:     numbers[0]  numbers[1]  numbers[2] ...
</pre>
        </div>
    </div>

    <h2>Пример 1: Креирање и пристап до низа</h2>
    <p>Еве како да креираш низа и да пристапиш до нејзините елементи:</p>

    <div class="code-container">
        <div class="form-check form-switch mb-2">
            <input class="form-check-input" type="checkbox" id="example1Toggle" onchange="window.convertCode('example1')">
            <label class="form-check-label" for="example1Toggle">Претвори во C#</label>
        </div>
        <div class="code-content">
<pre class="codeBlock" id="example1Code">
// Креирање низа со 5 броеви
int numbers[5] = {10, 20, 30, 40, 50};

// Пристап до поединечни елементи
cout << "Прв број: " << numbers[0] << endl;   // Индекс 0 = 10
cout << "Трет број: " << numbers[2] << endl; // Индекс 2 = 30
</pre>
        </div>
        <div class="result-box" id="example1Result">
            → <strong>Резултат:</strong><br>Прв број: 10<br>Трет број: 30<br>
            <em>Објаснување:</em> Низите започнуваат од индекс 0, па <code>numbers[0]</code> е првиот елемент (10), а <code>numbers[2]</code> е третиот елемент (30).
        </div>
    </div>

    <h2>Пример 2: Промена на вредности во низа</h2>
    <p>Можеш да ја промениш вредноста на која било позиција во низата:</p>

    <div class="code-container">
        <div class="form-check form-switch mb-2">
            <input class="form-check-input" type="checkbox" id="example2Toggle" onchange="window.convertCode('example2')">
            <label class="form-check-label" for="example2Toggle">Претвори во C#</label>
        </div>
        <div class="code-content">
<pre class="codeBlock" id="example2Code">
int scores[3] = {85, 90, 78};

// Промена на вториот резултат
scores[1] = 95;  // Ажурирање на индекс 1 од 90 на 95

// Прикажување на сите резултати
cout << "Резултати: ";
cout << scores[0] << " ";  // 85
cout << scores[1] << " ";  // 95
cout << scores[2];         // 78
</pre>
        </div>
        <div class="result-box" id="example2Result">
            → <strong>Резултат:</strong> Резултати: 85 95 78<br>
            <em>Објаснување:</em> Креиравме низа со 3 резултати, потоа ја сменивме вредноста на индекс 1 од 90 на 95.
        </div>
    </div>

    <h2>Пример 3: Низи + циклуси = моќна комбинација</h2>
    <p>Комбинирањето на низи со <code>for</code> циклуси овозможува лесна обработка на сите елементи. Ова е многу подобро отколку пишување посебен код за секој елемент.</p>

    <div class="code-container">
        <div class="form-check form-switch mb-2">
            <input class="form-check-input" type="checkbox" id="example3Toggle" onchange="window.convertCode('example3')">
            <label class="form-check-label" for="example3Toggle">Претвори во C#</label>
        </div>
        <div class="code-content">
<pre class="codeBlock" id="example3Code">
int numbers[5] = {10, 20, 30, 40, 50};
int sum = 0;

// Поминување низ сите елементи на низата
for (int i = 0; i < 5; i++) {
    sum += numbers[i];  // Додавање на секој број во сумата
    cout << "Се додава " << numbers[i] << endl;
}

cout << "Вкупна сума: " << sum << endl;
</pre>
        </div>
        <div class="result-box" id="example3Result">
            → <strong>Резултат:</strong><br>Се додава 10<br>Се додава 20<br>Се додава 30<br>Се додава 40<br>Се додава 50<br>Вкупна сума: 150<br>
            <em>Објаснување:</em> Циклусот оди од i=0 до i=4 и пристапува до секој елемент преку <code>numbers[i]</code>. Сите броеви се собираат заедно.
        </div>
    </div>

    <h2>Интерактивен водич: Следење на код со низа и циклус</h2>
    <p>Погледни како низата и циклусот работат заедно чекор по чекор:</p>

    <h2>Пример 4: Пронаоѓање на најголема вредност</h2>
    <p>Низите се идеални за задачи како пронаоѓање на максимална или минимална вредност:</p>

    <h2>Пример 5: Низи со стрингови</h2>
    <p>Низите можат да содржат и текст (стрингови):</p>

    <h2>Визуелен дијаграм: Низа во меморија</h2>

    <h2>Чести грешки што треба да се избегнат</h2>

    <h2>Резиме</h2>
    <ul>
        <li>Низите складираат <strong>повеќе вредности</strong> од ист тип во една променлива</li>
        <li>До елементите се пристапува преку <strong>индекс</strong> кој започнува од 0</li>
        <li>Низи + циклуси се <strong>моќна комбинација</strong> за обработка на податоци</li>
        <li>Честа употреба: листи, пресметка на збир, пронаоѓање минимум/максимум</li>
        <li>Внимавај да не пристапуваш <strong>надвор од границите на низата</strong> (пр. arr[5] за низа со 3 елементи)</li>
    </ul>

    <div class="navigation-buttons">
        <a href="@Url.Action("ForLoops", "SP")" class="btn btn-outline-primary ajax-link">← For циклиси</a>
        <a href="@Url.Action("StringArrays", "SP")" class="btn btn-primary ajax-link">Низи со стрингови →</a>
    </div>
</div>

<style>
    .container {
        max-width: 800px;
        padding: 20px;
        background-color: var(--bs-body-bg);
    }

    h1, h2 {
        color: var(--bs-heading-color);
        margin-bottom: 15px;
    }

    p, li, code {
        color: var(--bs-body-color);
        line-height: 1.6;
    }

    .code-container {
        margin: 25px 0;
        border: 1px solid var(--bs-border-color);
        border-radius: 5px;
        overflow: hidden;
        background-color: var(--code-bg);
    }

    .code-header {
        background-color: var(--code-header-bg);
        padding: 10px 15px;
        border-bottom: 1px solid var(--bs-border-color);
        font-family: 'SFMono-Regular', Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        font-size: 0.9rem;
        color: var(--bs-body-color);
    }

    .code-content {
        padding: 15px;
        overflow-x: auto;
    }

    pre {
        margin: 0;
        white-space: pre-wrap;
        background-color: transparent;
        font-family: 'SFMono-Regular', Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .result-box {
        padding: 10px 15px;
        background-color: rgba(0, 123, 255, 0.1);
        border-top: 1px solid var(--bs-border-color);
        font-size: 0.95rem;
    }

    .fade {
        opacity: 0;
        transition: opacity 0.25s ease;
    }

    .navigation-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 30px;
    }

    .btn {
        padding: 8px 20px;
        border-radius: 4px;
        font-weight: 500;
        text-decoration: none;
    }

    .btn-primary {
        background-color: var(--bs-primary);
        border-color: var(--bs-primary);
        color: #fff;
    }

    .btn-outline-primary {
        color: var(--bs-primary);
        border-color: var(--bs-primary);
        background-color: transparent;
    }
</style>

<script>
// Make all functions and data available globally
window.fullCodeLines = [
    'int numbers[5] = {10, 20, 30, 40, 50};',
    'int sum = 0;',
    'for (int i = 0; i < 5; i++) {',
    '    sum += numbers[i]; // ⬅ Run Code Block',
    '}',
    'cout << "Total: " << sum;'
];

window.traceSteps = [
    { line: 0, vars: 'i = ?, sum = 0, numbers = [10,20,30,40,50]', exp: 'Creates an array with 5 numbers.' },
    { line: 1, vars: 'i = ?, sum = 0, numbers = [10,20,30,40,50]', exp: 'Initializes <code>sum</code> to 0.' },
    { line: 2, vars: 'i = 0, sum = 0, numbers = [10,20,30,40,50]', exp: 'Initializes loop: <code>i = 0</code>. Checks condition: (0 < 5) is TRUE.' },
    { line: 3, vars: 'i = 0, sum = 10, numbers = [10,20,30,40,50]', exp: 'Iteration 1: <code>sum = 0 + numbers[0]</code> (which is 10).' },
    { line: 2, vars: 'i = 1, sum = 10, numbers = [10,20,30,40,50]', exp: 'Increment: <code>i++</code> (i is now 1). Check: (1 < 5) is TRUE.' },
    { line: 3, vars: 'i = 1, sum = 30, numbers = [10,20,30,40,50]', exp: 'Iteration 2: <code>sum = 10 + numbers[1]</code> (which is 20).' },
    { line: 2, vars: 'i = 2, sum = 30, numbers = [10,20,30,40,50]', exp: 'Increment: <code>i++</code> (i is now 2). Check: (2 < 5) is TRUE.' },
    { line: 3, vars: 'i = 2, sum = 60, numbers = [10,20,30,40,50]', exp: 'Iteration 3: <code>sum = 30 + numbers[2]</code> (which is 30).' },
    { line: 2, vars: 'i = 3, sum = 60, numbers = [10,20,30,40,50]', exp: 'Increment: <code>i++</code> (i is now 3). Check: (3 < 5) is TRUE.' },
    { line: 3, vars: 'i = 3, sum = 100, numbers = [10,20,30,40,50]', exp: 'Iteration 4: <code>sum = 60 + numbers[3]</code> (which is 40).' },
    { line: 2, vars: 'i = 4, sum = 100, numbers = [10,20,30,40,50]', exp: 'Increment: <code>i++</code> (i is now 4). Check: (4 < 5) is TRUE.' },
    { line: 3, vars: 'i = 4, sum = 150, numbers = [10,20,30,40,50]', exp: 'Iteration 5: <code>sum = 100 + numbers[4]</code> (which is 50).' },
    { line: 2, vars: 'i = 5, sum = 150, numbers = [10,20,30,40,50]', exp: 'Increment: <code>i++</code> (i is now 5). Check: (5 < 5) is FALSE. Loop ends.' },
    { line: 5, vars: 'i = 5, sum = 150, numbers = [10,20,30,40,50]', exp: 'Prints the final total sum.' }
];

// Initialize global state
window.currentTraceStep = 0;

window.cppSnippets = {
    example1: `// Создади низа со 5 броја
int numbers[5] = {10, 20, 30, 40, 50};

    // Пристапете до поединечни елементи
cout << "First number: " << numbers[0] << endl;  // Index 0 = 10
cout << "Third number: " << numbers[2] << endl;  // Index 2 = 30`,
    example2: `int scores[3] = {85, 90, 78};

    // Променете го вториот резултат
scores[1] = 95;  // Update index 1 from 90 to 95

    //Прикажи ги сите резултати
cout << "Scores: ";
cout << scores[0] << " ";  // 85
cout << scores[1] << " ";  // 95
cout << scores[2];         // 78`,
    example3: `int numbers[5] = {10, 20, 30, 40, 50};
int sum = 0;

        // Врти низ сите елементи на низата
for (int i = 0; i < 5; i++) {
        sum += numbers[i];  // Собери го секој број во збирот
    cout << "Adding " << numbers[i] << endl;
}

cout << "Total sum: " << sum << endl;`,
    example4: `int temperatures[6] = {22, 25, 19, 28, 23, 27};
    int maxTemp = temperatures[0];  // Започнете со првата температура

    // Проверете ја секоја температура
for (int i = 1; i < 6; i++) {
    if (temperatures[i] > maxTemp) {
            maxTemp = temperatures[i];  // Најдов повисока температура
    }
}

cout << "Highest temperature: " << maxTemp << "°C" << endl;`,
    example5: `string fruits[4] = {"apple", "banana", "orange", "grape"};

    // Прикажи ги сите плодови
for (int i = 0; i < 4; i++) {
    cout << "Fruit " << (i + 1) << ": " << fruits[i] << endl;
}`
};

window.csharpSnippets = {
        example1: `// Создади низа со 5 броја
int[] numbers = {10, 20, 30, 40, 50};

    // Пристапете до поединечни елементи
Console.WriteLine("First number: " + numbers[0]);  // Index 0 = 10
Console.WriteLine("Third number: " + numbers[2]);  // Index 2 = 30`,
    example2: `int[] scores = {85, 90, 78};

    // Променете го вториот резултат
scores[1] = 95;  // Update index 1 from 90 to 95

    // Прикажи ги сите резултати
Console.Write("Scores: ");
Console.Write(scores[0] + " ");  // 85
Console.Write(scores[1] + " ");  // 95
Console.Write(scores[2]);         // 78`,
    example3: `int[] numbers = {10, 20, 30, 40, 50};
int sum = 0;

    // Врти низ сите елементи на низата
for (int i = 0; i < numbers.Length; i++)
{
        sum += numbers[i];  // Собери го секој број во збирот
    Console.WriteLine("Adding " + numbers[i]);
}

Console.WriteLine("Total sum: " + sum);`,
    example4: `int[] temperatures = {22, 25, 19, 28, 23, 27};
    int maxTemp = temperatures[0];  // Започнете со првата температура

    // Проверете ја секоја температура
for (int i = 1; i < temperatures.Length; i++)
{
    if (temperatures[i] > maxTemp)
    {
            maxTemp = temperatures[i];  // Пронајдена е повисока температура
    }
}

Console.WriteLine("Highest temperature: " + maxTemp + "°C");`,
    example5: `string[] fruits = {"apple", "banana", "orange", "grape"};

    // Прикажи ги сите плодови
for (int i = 0; i < fruits.Length; i++)
{
    Console.WriteLine("Fruit " + (i + 1) + ": " + fruits[i]);
}`
};

// Function to convert code between C++ and C#
window.convertCode = function(id) {
    console.log("Converting code for:", id);
    const toggle = document.getElementById(id + "Toggle");
    const isCSharp = toggle ? toggle.checked : false;
    const codeBlock = document.getElementById(id + "Code");
    
    if (!codeBlock) {
        console.error("Code block not found for:", id);
        return;
    }
    
    codeBlock.classList.add("fade");
    setTimeout(() => {
        const newCode = isCSharp ? window.csharpSnippets[id] : window.cppSnippets[id];
        if (newCode) {
            codeBlock.textContent = newCode;
        }
        codeBlock.classList.remove("fade");
    }, 250);
};

// Function to update walkthrough
window.updateWalkthrough = function(step) {
    const walkthroughCodeBase = document.getElementById('walkthroughCodeBase');
    const walkthroughVariables = document.getElementById('walkthroughVariables');
    const walkthroughExplanation = document.getElementById('walkthroughExplanation');
    
    if (!walkthroughCodeBase || !walkthroughVariables || !walkthroughExplanation) return;
    
    const data = window.traceSteps[step];
    let codeContent = '';
    const activeLineIndex = data.line;
    
    window.fullCodeLines.forEach((line, index) => {
        if (index === activeLineIndex) {
            codeContent += `<span style="background-color: yellow; color: black;">${line.replace('// ⬅ Run Code Block', '⬅ ACTIVE')}</span>\n`;
        } else if (line.includes('// ⬅ Run Code Block')) {
            codeContent += `// ${line.replace('// ⬅ Run Code Block', '').trim()}\n`;
        } else if (index === 2 && activeLineIndex !== 2 && activeLineIndex !== 3) {
            codeContent += `// ${line.trim()}\n`;
        } else if (activeLineIndex >= 2 && activeLineIndex <= 4 && index > 4) {
            codeContent += `// ${line.trim()}\n`;
        } else if (index !== activeLineIndex) {
            codeContent += `${line}\n`;
        }
    });
    
    walkthroughCodeBase.innerHTML = codeContent;
    walkthroughVariables.textContent = data.vars;
    walkthroughExplanation.innerHTML = `<em>Explanation:</em> ${data.exp}`;
    
    if (step === window.traceSteps.length - 1) {
        walkthroughExplanation.innerHTML += '<br><strong>Trace finished! Final output is "Total: 150".</strong>';
        const nextStepBtn = document.getElementById('nextStepBtn');
        if (nextStepBtn) {
            nextStepBtn.disabled = true;
        }
    }
};

// Create global handler for walkthrough button
window.nextStepHandler = function() {
    if (window.currentTraceStep < window.traceSteps.length) {
        if (typeof window.updateWalkthrough === 'function') {
            window.updateWalkthrough(window.currentTraceStep);
            window.currentTraceStep++;
        }
    }
};

// Initialize all code examples on page load
function initializeCodeExamples() {
    console.log("Initializing Arrays page code examples");
    for (let i = 1; i <= 5; i++) {
        const toggle = document.getElementById(`example${i}Toggle`);
        const codeBlock = document.getElementById(`example${i}Code`);
        if (toggle && codeBlock) {
            const isCSharp = toggle.checked;
            const newCode = isCSharp ? window.csharpSnippets[`example${i}`] : window.cppSnippets[`example${i}`];
            if (newCode) {
                codeBlock.textContent = newCode;
            }
        }
    }
}

function initializeWalkthrough() {
    console.log("Initializing Arrays walkthrough");
    const nextStepBtn = document.getElementById('nextStepBtn');
    if (nextStepBtn) {
        window.currentTraceStep = 0;
        
        if (typeof window.updateWalkthrough === 'function') {
            window.updateWalkthrough(0);
            window.currentTraceStep = 1;
        }
        
        nextStepBtn.disabled = false;
    }
}

document.addEventListener('DOMContentLoaded', function() {
    console.log("DOM loaded, initializing Arrays page");
    initializeCodeExamples();
    initializeWalkthrough();
});

if (document.readyState === 'complete' || document.readyState === 'interactive') {
    setTimeout(function() {
        console.log("Document ready, initializing Arrays page");
        initializeCodeExamples();
        initializeWalkthrough();
    }, 100);
}

window.initializeArraysPage = function() {
    console.log("Initializing Arrays page via global function");
    initializeCodeExamples();
    initializeWalkthrough();
};
</script>