@{
    ViewData["Title"] = "OOP - Интерфејси";
}

<body data-topic="interfaces">
    <div class="container">
        <h1 class="mb-4">Интерфејси: Ветувања што класите ги исполнуваат</h1>

        <p><strong>Интерфејсите</strong> се како <strong>договори</strong> или <strong>планови</strong> кои велат: „Секоја класа што го прифаќа овој договор МОРА да ги направи овие работи“. Тие дефинираат ШТО може да прави една класа, но не и КАКО го прави тоа.</p>

        <p>Интерфејси гледате постојано во реалниот живот:</p>
        <ul>
            <li><strong>USB интерфејс</strong> – секој уред со USB приклучок МОРА да одговара и да комуницира</li>
            <li><strong>Опис на работно место</strong> – ги наведува вештините што кандидатите МОРА да ги имаат</li>
            <li><strong>Мени во ресторан</strong> – ветува јадења што ќе ги добиете ако нарачате</li>
            <li><strong>Електричен приклучок</strong> – секој приклучок што одговара МОРА да испорача струја правилно</li>
        </ul>

        <div class="note-box">
            <strong>Напредна тема:</strong> Интерфејсите се моќни, но можат да бидат тешки за почетници. Овде ги покриваме основите, а подетално ќе ги разгледаме во делот <strong>Advanced Web</strong>.
        </div>

        <h2>Што е интерфејс?</h2>
        <p>Интерфејс е <strong>договор</strong> што класите ветуваат дека ќе го исполнат:</p>

        <div class="code-container">
            <div class="code-header">Интерфејс = Договор</div>
            <div class="code-content">
<pre>
ИНТЕРФЕЈС (Договор)           КЛАСИ (Извршители)
────────────────────────────────────────────────
„Барам:“                     „Ветувам дека ќе обезбедам:“
• Метод StartEngine()         • Car: StartEngine() = вртење клуч
• Метод StopEngine()          • Motorcycle: StartEngine() = копче
• Својство Speed              • Boat: StartEngine() = повлекување јаже

ЕДЕН интерфејс може да го     МНОГУ класи можат да го имплементираат
────────────────────────────────────────────────
Клучна разлика од класите:
• Интерфејс: кажува ШТО мора да се направи
• Класа: покажува КАКО се прави
• Интерфејс: нема имплементација
• Класа: има целосна имплементација
</pre>
            </div>
        </div>

        <h2>Интерфејс синтакса</h2>
        <p>Интерфејсите по конвенција започнуваат со <code>I</code> и го користат клучниот збор <code>interface</code>:</p>

        <div class="code-container">
            <div class="form-check form-switch mb-2">
                <input class="form-check-input" type="checkbox" id="syntaxToggle" onchange="oopInterfaces.toggleSyntax()">
                <label class="form-check-label" for="syntaxToggle">Прикажи целосен синтаксен пример</label>
            </div>
            <div class="code-content">
<pre id="syntaxCode">
public interface IVehicle
{
    void Start();
    void Stop();

    int MaxSpeed { get; }
    string Model { get; set; }
}

public class Car : IVehicle
{
    public void Start()
    {
        Console.WriteLine("Моторот на автомобилот е стартуван со клуч.");
    }

    public void Stop()
    {
        Console.WriteLine("Моторот на автомобилот е изгасен.");
    }

    public int MaxSpeed
    {
        get { return 180; }
    }

    public string Model { get; set; }
}

public class Motorcycle : IVehicle
{
    public void Start()
    {
        Console.WriteLine("Моторот на моторот е стартуван со копче.");
    }

    public void Stop()
    {
        Console.WriteLine("Моторот на моторот е изгасен.");
    }

    public int MaxSpeed
    {
        get { return 150; }
    }

    public string Model { get; set; }
}
</pre>
            </div>
        </div>

        <h2>Пример 1: Интерфејс за возила</h2>

        <div class="code-container">
            <div class="form-check form-switch mb-2">
                <input class="form-check-input" type="checkbox" id="example1Toggle" onchange="oopInterfaces.convertCode('example1')">
                <label class="form-check-label" for="example1Toggle">Прикажи повеќе типови возила</label>
            </div>
            <div class="code-content">
<pre class="codeBlock" id="example1Code">
public interface IDrivable
{
    void Drive();
    void Park();
    int Speed { get; }
}

public class Car : IDrivable
{
    private int currentSpeed;

    public void Drive()
    {
        currentSpeed = 60;
        Console.WriteLine("Автомобилот вози со " + currentSpeed + " km/h.");
    }

    public void Park()
    {
        currentSpeed = 0;
        Console.WriteLine("Автомобилот е паркиран.");
    }

    public int Speed
    {
        get { return currentSpeed; }
    }
}

public class Truck : IDrivable
{
    private int currentSpeed;

    public void Drive()
    {
        currentSpeed = 45;
        Console.WriteLine("Камионот се движи со " + currentSpeed + " km/h.");
    }

    public void Park()
    {
        currentSpeed = 0;
        Console.WriteLine("Камионот е паркиран во товарна зона.");
    }

    public int Speed
    {
        get { return currentSpeed; }
    }
}

public class Motorcycle : IDrivable
{
    private int currentSpeed;

    public void Drive()
    {
        currentSpeed = 75;
        Console.WriteLine("Моторот се движи со " + currentSpeed + " km/h.");
    }

    public void Park()
    {
        currentSpeed = 0;
        Console.WriteLine("Моторот е паркиран.");
    }

    public int Speed
    {
        get { return currentSpeed; }
    }
}
</pre>
            </div>
        </div>

        <h2>Чести грешки со интерфејси</h2>
        <div class="code-container">
            <div class="code-content">
<pre>
// <span style="color:red; font-weight:bold;">ГРЕШКА: Не се имплементирани сите членови</span>
public interface ITest
{
    void A();
    void B();
}

public class MyClass : ITest
{
    public void A() { }
}

//<span style="color:lightgreen; font-weight:bold;"> ТОЧНО</span>
public class MyClassCorrect : ITest
{
    public void A() { }
    public void B() { }
}
</pre>
            </div>
        </div>

        <h2>Интерфејс наспроти апстрактна и обична класа</h2>
        <div class="code-container">
            <div class="code-content">
<pre>
ИНТЕРФЕЈС:
- Нема имплементација
- Може повеќекратно
- Само договор

АПСТРАКТНА КЛАСА:
- Делумна имплементација
- Еден родител
- Споделен код

ОБИЧНА КЛАСА:
- Целосна имплементација
- Се креираат објекти
</pre>
            </div>
        </div>

        <h2>Кога да користите интерфејси</h2>
        <div class="code-container">
            <div class="code-content">
<pre>
КОРИСТИ ИНТЕРФЕЈСИ КОГА:
- Ви треба договор
- Имате повеќе имплементации
- Сакате флексибилност
- Правите библиотеки или API

НЕ КОРИСТИ ИНТЕРФЕЈСИ КОГА:
- Ви треба споделен код
- Ви требаат полиња или конструктори
</pre>
            </div>
        </div>

        <h2>Резиме</h2>
        <ul>
            <li>Интерфејсите се договори што класите мора да ги исполнат</li>
            <li>Дефинираат ШТО, не КАКО</li>
            <li>Една класа може да имплементира повеќе интерфејси</li>
            <li>Обезбедуваат флексибилност и чиста архитектура</li>
        </ul>

        <div class="navigation-buttons">
            <a href="@Url.Action("Abstraction", "OOP")" class="btn btn-outline-primary ajax-link">← Апстракција</a>
            <a href="@Url.Action("StaticReadonlyConst", "OOP")" class="btn btn-primary ajax-link">Static, Readonly, Const →</a>
        </div>
    </div>


<style>
    .container {
        max-width: 800px;
        padding: 20px;
        background-color: var(--bs-body-bg);
    }

    h1, h2, h3 {
        color: var(--bs-heading-color);
        margin-bottom: 15px;
    }

    h1 {
        border-bottom: 2px solid var(--bs-primary);
        padding-bottom: 10px;
    }

    p, li, code {
        color: var(--bs-body-color);
        line-height: 1.6;
    }

    .note-box {
        background-color: rgba(255, 193, 7, 0.1);
        border: 1px solid var(--bs-warning);
        border-radius: 5px;
        padding: 15px;
        margin: 20px 0;
    }

    .code-container {
        margin: 25px 0;
        border: 1px sol id var(--bs-border-color);
        border-radius: 5px;
        overflow: hidden;
        background-color: var(--code-bg);
    }

    .code-header {
        background-color: var(--code-header-bg);
        padding: 10px 15px;
        border-bottom: 1px solid var(--bs-border-color);
        font-family: 'SFMono-Regular', Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        font-size: 0.9rem;
        color: var(--bs-body-color);
    }

    .code-content {
        padding: 15px;
        overflow-x: auto;
    }

    pre {
        margin: 0;
        white-space: pre-wrap;
        background-color: transparent;
        font-family: 'SFMono-Regular', Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .result-box {
        padding: 10px 15px;
        background-color: rgba(0, 123, 255, 0.1);
        border-top: 1px solid var(--bs-border-color);
        font-size: 0.95rem;
    }

    .navigation-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 30px;
    }

    .btn {
        padding: 8px 20px;
        border-radius: 4px;
        font-weight: 500;
        text-decoration: none;
    }

    .btn-primary {
        background-color: var(--bs-primary);
        border-color: var(--bs-primary);
        color: #fff;
    }

    .btn-outline-primary {
        color: var(--bs-primary);
        border-color: var(--bs-primary);
        background-color: transparent;
    }
</style>

    <script>
            window.oopInterfaces = {
                interfaceSteps: [
                    {
                        code: `public interface IPlayable
        {
            void Play();
            void Pause();
            string GetStatus();
        }

        // public class MusicPlayer : IPlayable
        // {
        //     // Мора да се имплементираат СИТЕ методи од интерфејсот
        //     public void Play() { Console.WriteLine("Music playing..."); }
        //     public void Pause() { Console.WriteLine("Music paused."); }
        //     public string GetStatus() { return "Playing song"; }
        // }

        // IPlayable player = new MusicPlayer();
        // player.Play();
        // player.Pause();
        // Console.WriteLine(player.GetStatus());`,
                        vars: `IPlayable интерфејсот дефинира договор:
        1. Play() - без параметри, враќа void
        2. Pause() - без параметри, враќа void
        3. GetStatus() - без параметри, враќа string

        Секоја класа што го имплементира МОРА да ги обезбеди овие три методи точно како што се дефинирани.`,
                        exp: "Дефинираме IPlayable интерфејс. Размислувај за него како опис на работа: „За да бидеш playable, мора да можеш да Play, Pause и да вратиш Status“. Интерфејсот кажува ШТО мора да постои, не КАКО."
                    },
                    {
                        code: `public interface IPlayable
        {
            void Play();
            void Pause();
            string GetStatus();
        }

        public class MusicPlayer : IPlayable
        {
            // Мора да се имплементираат СИТЕ методи од интерфејсот
            public void Play() { Console.WriteLine("Music playing..."); }
            public void Pause() { Console.WriteLine("Music paused."); }
            public string GetStatus() { return "Playing song"; }
        }

        // IPlayable player = new MusicPlayer();
        // player.Play();
        // player.Pause();
        // Console.WriteLine(player.GetStatus());`,
                        vars: `MusicPlayer класата ГО ИМПЛЕМЕНТИРА IPlayable:
        - Користи : IPlayable (две точки значи „имплементира“)
        - Ги обезбедува СИТЕ потребни методи:
          1. Play() - печати "Music playing..."
          2. Pause() - печати "Music paused."
          3. GetStatus() - враќа "Playing song"

        Класата ГО ИСПОЛНУВА договорот на интерфејсот.`,
                        exp: "Класата MusicPlayer го прифаќа договорот на IPlayable со користење на : IPlayable. Таа мора да обезбеди имплементација за сите три методи. Забелешка: Потписите на методите (име, параметри, тип на враќање) МОРА да се совпаѓаат точно."
                    },
                    {
                        code: `public interface IPlayable
        {
            void Play();
            void Pause();
            string GetStatus();
        }

        public class MusicPlayer : IPlayable
        {
            // Мора да се имплементираат СИТЕ методи од интерфејсот
            public void Play() { Console.WriteLine("Music playing..."); }
            public void Pause() { Console.WriteLine("Music paused."); }
            public string GetStatus() { return "Playing song"; }
        }

        IPlayable player = new MusicPlayer();
        // player.Play();
        // player.Pause();
        // Console.WriteLine(player.GetStatus());`,
                        vars: `Креирана е player променлива:
        - Тип: IPlayable (тип на интерфејс)
        - Објект: new MusicPlayer() (конкретна класа)

        Ова е КЛУЧНО: Објект од MusicPlayer се чува во променлива од тип IPlayable.
        Сега можеме да го третираме како БИЛО КОЈ IPlayable, не само MusicPlayer.`,
                        exp: "Креираме променлива player од тип IPlayable, но ѝ доделуваме објект од MusicPlayer. Ова е полиморфизам. Променливата знае само за методите од IPlayable договорот, не и за други методи на MusicPlayer."
                    },
                    {
                        code: `public interface IPlayable
        {
            void Play();
            void Pause();
            string GetStatus();
        }

        public class MusicPlayer : IPlayable
        {
            // Мора да се имплементираат СИТЕ методи од интерфејсот
            public void Play() { Console.WriteLine("Music playing..."); }
            public void Pause() { Console.WriteLine("Music paused."); }
            public string GetStatus() { return "Playing song"; }
        }

        IPlayable player = new MusicPlayer();
        player.Play();  // Повикување метод од интерфејсот
        // player.Pause();
        // Console.WriteLine(player.GetStatus());`,
                        vars: `Повикување: player.Play()
        - player е од тип IPlayable
        - IPlayable има Play() метод
        - Реалниот објект е MusicPlayer
        - Се повикува MusicPlayer.Play() имплементацијата

        Излез: "Music playing..."`,
                        exp: "Го повикуваме player.Play(). Иако player е деклариран како IPlayable, при извршување се повикува вистинската имплементација од MusicPlayer. Интерфејсот служи како посредник – комуницираме преку договорот."
                    },
                    {
                        code: `public interface IPlayable
        {
            void Play();
            void Pause();
            string GetStatus();
        }

        public class MusicPlayer : IPlayable
        {
            // Мора да се имплементираат СИТЕ методи од интерфејсот
            public void Play() { Console.WriteLine("Music playing..."); }
            public void Pause() { Console.WriteLine("Music paused."); }
            public string GetStatus() { return "Playing song"; }
        }

        IPlayable player = new MusicPlayer();
        player.Play();
        player.Pause();
        Console.WriteLine(player.GetStatus());`,
                        vars: `Повикани се сите методи од интерфејсот:
        1. player.Play() → "Music playing..."
        2. player.Pause() → "Music paused."
        3. player.GetStatus() → враќа "Playing song"

        Договорот на интерфејсот е целосно исполнет.
        Подоцна можеме да го замениме MusicPlayer со VideoPlayer!`,
                        exp: "Сите три методи функционираат преку IPlayable променливата. Предноста: утре можеме да креираме VideoPlayer класа што исто така имплементира IPlayable и кодот за повикување нема да се смени."
                    }
                ],

                simpleExamples: {
                    example1: `// Интерфејс: ШТО МОРА да прават сите возила
        public interface IDrivable
        {
            void Drive();
            void Park();
            int Speed { get; }
        }

        // Car имплементира IDrivable
        public class Car : IDrivable
        {
            private int currentSpeed;

            public void Drive()
            {
                currentSpeed = 60;
                Console.WriteLine("Car is driving at " + currentSpeed + " mph.");
            }

            public void Park()
            {
                currentSpeed = 0;
                Console.WriteLine("Car parked safely.");
            }

            public int Speed
            {
                get { return currentSpeed; }
            }
        }

        // Truck исто така имплементира IDrivable
        public class Truck : IDrivable
        {
            private int currentSpeed;

            public void Drive()
            {
                currentSpeed = 45;
                Console.WriteLine("Truck is hauling at " + currentSpeed + " mph.");
            }

            public void Park()
            {
                currentSpeed = 0;
                Console.WriteLine("Truck parked in loading zone.");
            }

            public int Speed
            {
                get { return currentSpeed; }
            }
        }`,
                    example2: `// Интерфејс 1: Може да повикува
        public interface IPhone
        {
            void Call(string number);
            void ReceiveCall();
            string PhoneNumber { get; set; }
        }

        // Интерфејс 2: Може да фотографира
        public interface ICamera
        {
            void TakePhoto();
            void RecordVideo();
            int Megapixels { get; }
        }

        // Smartphone ги имплементира СИТЕ интерфејси
        public class Smartphone : IPhone, ICamera
        {
            // IPhone имплементација
            public string PhoneNumber { get; set; }

            public void Call(string number)
            {
                Console.WriteLine("Calling " + number + " from " + PhoneNumber);
            }

            public void ReceiveCall()
            {
                Console.WriteLine("Incoming call on " + PhoneNumber);
            }

            // ICamera имплементација
            public int Megapixels { get { return 12; } }

            public void TakePhoto()
            {
                Console.WriteLine("Taking photo with " + Megapixels + "MP camera");
            }

            public void RecordVideo()
            {
                Console.WriteLine("Recording 4K video");
            }
        }`
                }
            };
                codeBlock.style.transition = 'opacity 0.3s ease';
                codeBlock.style.opacity = '0.5';
                setTimeout(() => {
                    codeBlock.textContent = isComplete ? completeSyntax : simpleSyntax;
                    codeBlock.style.opacity = '1';
                }, 300);
            }
        },

        convertCode: function(id) {
            const toggle = document.getElementById(id + "Toggle");
            const isComplete = toggle ? toggle.checked : false;
            const codeBlock = document.getElementById(id + "Code");
            const resultBox = document.getElementById(id + "Result");

            if (codeBlock && toggle) {
                codeBlock.style.transition = 'opacity 0.3s ease';
                codeBlock.style.opacity = '0.5';
                setTimeout(() => {
                    codeBlock.textContent = isComplete ? this.completeExamples[id] : this.simpleExamples[id];
                    codeBlock.style.opacity = '1';

                    if (resultBox && id === 'example1') {
                        resultBox.innerHTML = isComplete ? 
                            ' <strong>Output:</strong><br>=== Driving Different Vehicles ===<br>Car is driving at 60 mph.<br>Car parked safely.<br>Current speed: 0 mph<br>---<br>Truck is hauling at 45 mph.<br>Truck parked in loading zone.<br>Current speed: 0 mph<br>---<br>Motorcycle zooming at 75 mph!<br>Motorcycle parked on kickstand.<br>Current speed: 0 mph<br>---<br><br><em>Interface Magic:</em> All three classes (Car, Truck, Motorcycle) implement the SAME <code>IDrivable</code> interface. We can store them all in an <code>IDrivable[]</code> array and call the same methods on each, but each executes its own implementation!' :
                            ' <strong>Code Structure:</strong><br>IDrivable interface with Drive(), Park(), and Speed property.<br>Car class implements IDrivable with car-specific behavior.<br>Truck class implements IDrivable with truck-specific behavior.<br><br><em>Toggle to see the complete example with Motorcycle and array usage!</em>';
                    } else if (resultBox && id === 'example2') {
                        resultBox.innerHTML = isComplete ?
                            ' <strong>Output:</strong><br>Calling 555-5678 from 555-1234<br>Taking photo with 12MP camera<br>Browsing: https://example.com<br><br>=== Using All Features ===<br>Calling 911 from 555-1234<br>Taking photo with 12MP camera<br>Browsing: https://google.com<br>Recording 4K video<br><br>Phone has: 12MP camera<br>Phone number: 555-1234<br><br><em>Multiple Interfaces:</em> Smartphone implements THREE interfaces (IPhone, ICamera, IInternetBrowser). This is like saying "A smartphone IS A phone AND a camera AND a browser." This is how C# achieves "multiple inheritance" - through multiple interfaces!' :
                            ' <strong>Code Structure:</strong><br>IPhone interface for calling features.<br>ICamera interface for photo/video features.<br>Smartphone class implements BOTH interfaces.<br>Can use smartphone as phone OR camera OR both.<br><br><em>Toggle to see the complete example with browser interface and full usage!</em>';
                    }
                }, 300);
            }
        },

        updateWalkthrough: function(step) {
            const walkthroughCodeBase = document.getElementById('walkthroughCodeBase');
            const walkthroughVariables = document.getElementById('walkthroughVariables');
            const walkthroughExplanation = document.getElementById('walkthroughExplanation');
            const nextStepBtn = document.getElementById('nextStepBtn');

            if (!walkthroughCodeBase || !walkthroughVariables || !walkthroughExplanation) return;

            const data = this.interfaceSteps[step];
            
            walkthroughCodeBase.textContent = data.code;
            walkthroughVariables.textContent = data.vars;
            walkthroughExplanation.innerHTML = `<em>Step ${step + 1}:</em> ${data.exp}`;
            
            if (step === this.interfaceSteps.length - 1 && nextStepBtn) {
                walkthroughExplanation.innerHTML += '<br><strong> Complete! The interface acts as a contract that MusicPlayer fulfills.</strong>';
                nextStepBtn.disabled = true;
            }
        },

        nextStep: function() {
            if (this.currentStep < this.interfaceSteps.length) {
                this.updateWalkthrough(this.currentStep);
                this.currentStep++;
            }
        },

        initWalkthrough: function() {
            const nextStepBtn = document.getElementById('nextStepBtn');
            if (nextStepBtn) {
                this.currentStep = 0;

                const newButton = nextStepBtn.cloneNode(true);
                nextStepBtn.parentNode.replaceChild(newButton, nextStepBtn);

                newButton.addEventListener('click', () => this.nextStep());
                newButton.disabled = false;

                this.updateWalkthrough(0);
                this.currentStep = 1;
            }
        },

        initCodeExamples: function() {
            const toggles = document.querySelectorAll('.form-check-input[type="checkbox"]');
            toggles.forEach(toggle => {
                const id = toggle.id.replace('Toggle', '');
                if (id === 'syntaxToggle') {
                    this.toggleSyntax();
                    toggle.addEventListener('change', () => this.toggleSyntax());
                } else if (id && this.simpleExamples[id]) {
                    this.convertCode(id);
                    toggle.addEventListener('change', () => this.convertCode(id));
                }
            });
        },

        init: function() {
            console.log('Initializing OOP Interfaces page');
            this.initCodeExamples();
            this.initWalkthrough();

            if (typeof hljs !== 'undefined') {
                hljs.highlightAll();
            }
        }
    };

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            window.oopInterfaces.init();
        });
    } else {
        window.oopInterfaces.init();
    }
</script>
</body>